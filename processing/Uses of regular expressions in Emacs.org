#+TITLE: Uses of regular expressions in Emacs
#+URL: https://www.johndcook.com/blog/2018/01/27/emacs-features-that-use-regular-expressions/
#+AUTHOR: lujun9972
#+TAGS: raw
#+DATE: [2018年 07月 06日 星期五 14:57:15 CST]
#+LANGUAGE:  zh-CN
#+OPTIONS:  H:6 num:nil toc:t n:nil ::t |:t ^:nil -:nil f:t *:t <:nil
The syntax of regular expressions in Emacs is a little disappointing, but the ways you can use regular expressions in Emacs is impressive.
Emacs中正则表达式的语法有点令人失望，但是在Emacs中使用正则表达式的方式令人印象深刻。

I've written [[https://www.johndcook.com/blog/regex-perl-python-emacs/][before]] about the syntax of Emacs regular expressions. It's a pretty conservative subset of the features you may be used to from other environments as summarized in the diagram below.
我曾经写过[[https://www.johndcook.com/blog/regexperl-pythonemacs/][以前]]关于Emacs正则表达式的语法。它是您可能从其他环境中使用的功能的一个相当保守的子集，如下图所示。

[[https://www.johndcook.com/blog/regex-perl-python-emacs/][[[//www.johndcook.com/perl-python-emacs.png]]]]
[[https://www.johndcook.com/blog/regex-perl-python-emacs/] [[[/ /www.johndcook.com/perl-python-emacs.png]]]]

But there are many, many was to use regular expressions in Emacs. I did a quick search and found that about 15% of the pages in the massive Emacs manual contain at least one reference to regular expressions. Exhaustively listing the uses of regular expressions would not be practical or very interesting. Instead, I'll highlight a few uses that I find helpful.
但是在Emacs中有很多，很多是使用正则表达式的。我快速地搜索了一下，发现在大量Emacs手册中，大约15%的页面包含至少一个对正则表达式的引用。详尽地列出正则表达式的用法既不实际也不有趣。相反，我将重点介绍一些我认为有用的用法。

* Searching and replacing
*搜寻及更换
:PROPERTIES:
属性:
:CUSTOM_ID: searching-and-replacing
:CUSTOM_ID searching-and-replacing
:END:
结束:

One of the most frequently used features in Emacs is incremental search. You can search forward or backward for a string, searching as you type, with the commands =C-s= (=isearch-forward=) and =C-r= (=isearch-backward=). The regular expression counterparts of these commands are =C-M-s= (=isearch-forward-regexp=) and =C-M-r= (=isearch-backward-regexp=).
Emacs中最常用的特性之一是增量搜索。您可以使用=C-s= (=isearch-forward=)和=C-r= (=isearch-back =)命令在键入时向前或向后搜索字符串。这些命令对应的正则表达式是=C-M-s= (=isearch-forward-regexp=)和=C-M-r= (=isearch-back -regexp=)。

Note that the regular expression commands add the Alt (meta) key to their string counterparts. Also, note that Emacs consistently refers to regular expressions as =regexp= and never, as far as I know, as =regex=. (Emacs relies heavily on [[https://www.johndcook.com/blog/2011/05/26/software-architecture-and-trust/][conventions]] like this to keep the code base manageable.)
注意，正则表达式命令将Alt (meta)键添加到对应的字符串中。另外，请注意，Emacs始终将正则表达式引用为=regexp=，而从未将正则表达式引用为=regex=。(Emacs严重依赖于[[https://www.johndcook.com/blog/2011/05/26/softwarearchitecture-trust/][惯例]]这样的协议来保持代码库的可管理性。)

A common task in any editor is to search and replace text. In Emacs you can replace all occurrences of a regular expression with =replace-regexp= or interactively choose which instances to replace with =query-replace-regexp=.
在任何编辑器中，一个常见的任务是搜索和替换文本。在Emacs中，可以用=replace-regexp=替换所有出现的正则表达式，或者交互地选择用=query-replace-regexp=替换哪个实例。

* Purging lines
*清洗线
:PROPERTIES:
属性:
:CUSTOM_ID: purging-lines
:CUSTOM_ID purging-lines
:END:
结束:

You can delete all lines in a file that contain a given regular expression with =flush-lines=. You can also invert this command, specifying which lines not to delete with =keep-lines=.
可以用=flush-lines=删除文件中包含给定正则表达式的所有行。您还可以反转此命令，使用=keep-lines=指定不删除哪些行。

* Aligning code
*调整代码
:PROPERTIES:
属性:
:CUSTOM_ID: aligning-code
:CUSTOM_ID aligning-code
:END:
结束:

One lesser-known but handy feature is =align-regexp=. This command will insert white space as needed so that all instances of a regular expression in a region align vertically. For example, if you have a sequence of assignment statements in a programming language you could have all the equal signs line up by using =align-regexp= with the regular expression consisting simply of an equal sign. Of course you could also align based on a much more complex pattern.
一个不太为人所知但很方便的特性是=align-regexp=。此命令将根据需要插入空白，以便区域内正则表达式的所有实例垂直对齐。例如，如果在编程语言中有一个赋值语句序列，则可以使用=align-regexp=将所有的等号与只包含等号的正则表达式对齐。当然，您也可以根据更复杂的模式进行排列。

Although I imagine this feature is primarily used when editing source code, I imagine you could use it in other context such as aligning poetry or [[https://www.johndcook.com/blog/2016/06/15/ascii-art-diagrams-in-emacs-org-mode/][ASCII art diagrams]].
虽然我认为这个特性主要用于编辑源代码，但我认为您可以在其他环境中使用它，比如调整诗歌或[[https://www.johndcook.com/blog/2016/06/15/ascii-art- diams -in-emacs-org-mode/][ASCII艺术图]]。

* Directory editing
*目录编辑
:PROPERTIES:
属性:
:CUSTOM_ID: directory-editing
:CUSTOM_ID directory-editing
:END:
结束:

The Emacs directory editor =dired= is something like the Windows File Explorer or the OSX Finder, but text-based. =dired= has many features that use regular expressions. Here are a few of the more common ones.
Emacs目录编辑器=dired=类似于Windows文件管理器或OSX Finder，但是基于文本。=dired=有许多使用正则表达式的特性。以下是一些比较常见的例子。

You can mark files based on the file names with =% m= (=dired-mark-files-regexp=) or based on the contents of the files with =% g= (=dired-mark-files-containing-regexp=). You can also mark files for deletion with =% d= (=dired-flag-files-regexp=).
可以使用=% m= (=dired-mark-files-regexp=)根据文件名标记文件，也可以使用=% g= (=dired-mark-files-containing-regexp=)根据文件内容标记文件。您还可以使用=% d= (=dired-flag-files-regexp=)标记要删除的文件。

Inside =dired= you can search across a specified set of files by typing =A= (=dired-do-find-regexp=), and you can interactively search and replace across a set of files by typing =Q= (=dired-do-find-regexp-and-replace=).
在=dired=内部，您可以通过键入= a = (=dired-do-find-regexp=)来搜索指定的文件集，并且可以通过键入=Q= (=dired-do-find- regexpand -replace=)来交互式地搜索和替换一组文件。

* Miscellaneous
*杂项
:PROPERTIES:
属性:
:CUSTOM_ID: miscellaneous
:CUSTOM_ID:杂项
:END:
结束:

The help apropos command (=C-h a=) can take a string or a regular expression.
help apropos命令(=C-h a=)可以接受字符串或正则表达式。

The command to search for available fonts (=list-faces-display=) can take a string or regular expression.
搜索可用字体的命令(=list-faces-display=)可以使用字符串或正则表达式。

Interactive highlighting commands (=highlight-regexp=, =unhighlight-regexp=, =highlight-lines-matching-regexp=) take a regular expression argument.
交互式突出显示命令(=highlight-regexp=， =unhighlight-regexp=， =highlight-line - matchings -regexp=)接受一个正则表达式参数。

You can use a regular expression to specify which buffers to close with =kill-matching-buffers=.
可以使用正则表达式指定使用哪个缓冲区关闭=kill-match -buffers=。

Maybe the largest class of uses for regular expressions in Emacs is configuration. Many customizations in Emacs, such as giving Emacs hints to determine the right editing mode for a file or how to recognize comments in different languages, use regular expressions as arguments.
也许Emacs中正则表达式的最大用途是配置。Emacs中的许多自定义操作(例如给出Emacs提示以确定文件的正确编辑模式或如何识别不同语言中的注释)都使用正则表达式作为参数。

* Resources
*资源
:PROPERTIES:
属性:
:CUSTOM_ID: resources
:CUSTOM_ID:资源
:END:
结束:

You can find more posts on regular expressions and on Emacs by going to my [[https://www.johndcook.com/blog/notes/][technical notes]] page. Note that the outline at the top has links for [[https://www.johndcook.com/blog/notes/#regex][regular expressions]]\
and for [[https://www.johndcook.com/blog/notes/#emacs][Emacs]].
emacs和[[https://www.johndcook.com/blog/notes/] [emacs]]。

For daily tips on regular expressions or Unix-native tools like Emacs, follow [[https://twitter.com/regextip][@RegexTip]] and [[https://twitter.com/unixtooltip][@UnixToolTip]] on Twitter.
关于正则表达式或像Emacs这样的unix本地工具的每日提示，请在Twitter上关注[[https://twitter.com/regextip][@RegexTip]]和[[https://twitter.com/unixtooltip][@UnixToolTip]]。
