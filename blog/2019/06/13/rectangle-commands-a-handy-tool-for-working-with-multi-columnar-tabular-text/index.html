<!DOCTYPE html>
<html lang="en">
<head>
  <title>Rectangle Commands: A handy tool for working with multi-columnar / tabular text - EMACS-DOCUMENT</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <meta name="author" content="lujun9972" />
  <meta name="keywords" content="raw" />
  <!-- <link rel="stylesheet" href="../../../../../media/css/main.css" type="text/css"/>
       <link rel="stylesheet" href="../../../../../media/css/comment.css" type="text/css"/> -->
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/dark.css'>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
</head>

  <body><div class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="../../../../../">EMACS-DOCUMENT</a></h1>
    <p>=============&gt;随便,谢谢</p>
    <nav class="site-nav">
      <ul class="trigger">
        <li><a href="../../../../../years/">Years</a></li>
        <li><a href="../../../../../authors/">Authors</a></li>
        <li><a href="../../../../../tags/">Tags</a></li>
        <li><a href="../../../../../about/">About</a></li>
        <li><a href="https://github.com/lujun9972/emacs-document.git">Github</a></li>
        <li><a href="../../../../../rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="https://www.bing.com/search">
      <input type="text" class="field" name="q" id="s" placeholder="Search">
      <input type="hidden" name="as_sitesearch" value="lujun9972.github.io/emacs-document">
    </form>
  </header>
</div>

<div>
<div class="post">
<h1 class="title">Rectangle Commands: A handy tool for working with multi-columnar / tabular text</h1>
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#a-problem-and-a-solution">A Problem ... and a Solution</a></li>
<li><a href="#what-do-rectangle-commands-do">What do <code>rectangle</code> commands do?</a></li>
<li><a href="#step-1-create-a-menu">Step 1: Create a menu</a></li>
<li><a href="#step-2-ensure-that-you-have-set-up-the-above-snippet-correctly">Step 2:  Ensure that you have set up the above snippet correctly</a></li>
<li><a href="#step-3-copy-the-input-table-in-to-an-emacs-buffer">Step 3: Copy the input table in to an Emacs buffer</a></li>
<li><a href="#step-4-do-the-conversion">Step 4:   Do the conversion</a></li>
<li><a href="#concluding-words">Concluding Words</a></li>
<li><a href="#appendix">Appendix</a></li>
</ul>
</div>
</div>

<div id="outline-container-org1a0a0d1" class="outline-2">
<h2 id="a-problem-and-a-solution"><a id="org1a0a0d1"></a>A Problem ... and a Solution</h2>
<div class="outline-text-2" id="text-a-problem-and-a-solution">
<p>
You are given this <a href="https://github.com/emacksnotes/emacsnotes.wordpress.com/blob/a382a312e2472937e95624a33f06bb4a9cacb7b6/my-rect-menu.el#L1">(1)</a>
</p>

<pre class="example">
a b c
aaaa bb ccccc
aaa bbb cccc
aa bb ccc
</pre>

<p>
How would you generate this
</p>

<pre class="example">
[ a , b , c ]
[ aaaa, bb , ccccc ]
[ aaa , bbb, cccc ]
[ aa , bb , ccc ]
</pre>

<p>
A answer is you use Emacs' built-in <code>rectangle</code> commands.
</p>

<p>
[<a href="https://emacsnotes.files.wordpress.com/2019/05/rect-goal-2019-05-19.gif">CLICK HERE FOR UNSCALED GIF</a>]
</p>

<p>
<a href="https://emacsnotes.files.wordpress.com/2019/05/rect-goal-2019-05-19.gif?w=740">https://emacsnotes.files.wordpress.com/2019/05/rect-goal-2019-05-19.gif?w=740</a>
</p>

<p>
[<a href="https://emacsnotes.files.wordpress.com/2019/05/rect-goal-2019-05-19.gif">CLICK HERE FOR UNSCALED GIF</a>]
</p>
</div>
</div>

<div id="outline-container-orgb0e4066" class="outline-2">
<h2 id="what-do-rectangle-commands-do"><a id="orgb0e4066"></a>What do <code>rectangle</code> commands do?</h2>
<div class="outline-text-2" id="text-what-do-rectangle-commands-do">
<p>
The Emacs manual says <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles.html">(1)</a>
</p>

<blockquote>
<p>
“Rectangle” commands operate on rectangular areas of the text: all the<br />
characters between a certain pair of columns, in a certain range of<br />
lines.  They  are useful with text in multi-column formats, and for<br />
changing text into or out of such formats.
</p>
</blockquote>

<p>
The above description is too terse, and doesn't tell you what the commands do in a simple and relatable way.   In my opinion,
</p>

<blockquote>
<p>
<code>rectangle</code> commands are primitive tools to create pretty tables from a region of text and convert those tables in to different table formats like <code>TSV</code> <a href="https://en.wikipedia.org/wiki/Tab-separated_values">(1)</a>, <code>CSV</code> <a href="https://en.wikipedia.org/wiki/Comma-separated_values">(1)</a>, <code>Org</code> <a href="https://www.gnu.org/software/emacs/manual/html_node/org/Built_002din-table-editor.html#Built_002din-table-editor">(1)</a>, <code>LaTeX</code> <a href="https://en.wikibooks.org/wiki/LaTeX/Mathematics#Matrices_and_arrays">(1)</a>, <code>GFM</code> <a href="https://docs.gitlab.com/ee/user/markdown.html#tables">(1)</a>, <a href="https://help.github.com/articles/organizing-information-with-tables/"> (2)</a>  or any other makeshift format that you may come up with.
</p>
</blockquote>

<p>
Note that <code>rectangle</code> commands are primitive i.e., you can create pretty tables, but NOT in a single-shot but in multiple steps.
</p>
</div>
</div>

<div id="outline-container-org8472d34" class="outline-2">
<h2 id="step-1-create-a-menu"><a id="org8472d34"></a>Step 1: Create a menu</h2>
<div class="outline-text-2" id="text-step-1-create-a-menu">
<p>
Copy the <code>Emacs Lisp</code> snippet <a href="https://raw.githubusercontent.com/emacksnotes/emacsnotes.wordpress.com/master/my-rect-menu.el">(1)</a> below to your <code>.emacs</code> and restart your <code>Emacs</code>.
</p>

<pre class="example">
(require 'easymenu)

(dolist
 (item
 '((begin-tabify menu-item "--")
 ["Tabify" tabify :help "(tabify START END &amp;optional ARG)\n\nConvert multiple spaces in region to tabs when possible.\nA group of spaces is partially replaced by tabs\nwhen this can be done without changing the column they end at.\nIf called interactively with prefix ARG, convert for the entire\nbuffer.\n\nCalled non-interactively, the region is specified by arguments\nSTART and END, rather than by the position of point and mark.\nThe variable `tab-width' controls the spacing of tab stops."]
 ["Untabify" untabify :help "(untabify START END &amp;optional ARG)\n\nConvert all tabs in region to multiple spaces, preserving columns.\nIf called interactively with prefix ARG, convert for the entire\nbuffer.\n\nCalled non-interactively, the region is specified by arguments\nSTART and END, rather than by the position of point and mark.\nThe variable `tab-width' controls the spacing of tab stops."]
 (after-tabify menu-item "--")))
 (easy-menu-add-item global-map
 '("menu-bar" "edit")
 item "bookmark"))

(easy-menu-add-item global-map
 '("menu-bar" "edit")
 ["Rectangle Mark Mode" rectangle-mark-mode :style toggle :selected rectangle-mark-mode :help "(rectangle-mark-mode &amp;optional ARG)\n\nToggle the region as rectangular.\nActivates the region if needed. Only lasts until the region is deactivated."]
 "bookmark")

(with-eval-after-load 'rect
 (easy-menu-define my-rectangle-mark-mode-map-menu rectangle-mark-mode-map "Menu for Rectangle Mark Mode Map."
 '("Rectangle"
 ["String Rectangle" string-rectangle :help "(string-rectangle START END STRING)\n\nReplace rectangle contents with STRING on each line.\nThe length of STRING need not be the same as the rectangle width.\n\nWhen called interactively and option `rectangle-preview' is\nnon-nil, display the result as the user enters the string into\nthe minibuffer.\n\nCalled from a program, takes three args; START, END and STRING."]
 ["Delete Rectangle" delete-rectangle :help "(delete-rectangle START END &amp;optional FILL)\n\nDelete (don't save) text in the region-rectangle.\nThe same range of columns is deleted in each line starting with the\nline where the region begins and ending with the line where the region\nends.\n\nWhen called from a program the rectangle's corners are START and END.\nWith a prefix (or a FILL) argument, also fill lines where nothing has\nto be deleted."]
 "--"
 ["Kill Rectangle" kill-rectangle :help "(kill-rectangle START END &amp;optional FILL)\n\nDelete the region-rectangle and save it as the last killed one.\n\nWhen called from a program the rectangle's corners are START and END.\nYou might prefer to use `delete-extract-rectangle' from a program.\n\nWith a prefix (or a FILL) argument, also fill lines where nothing has to be\ndeleted.\n\nIf the buffer is read-only, Emacs will beep and refrain from deleting\nthe rectangle, but put it in `killed-rectangle' anyway. This means that\nyou can use this command to copy text from a read-only buffer.\n(If the variable `kill-read-only-ok' is non-nil, then this won't\neven beep.)"]
 ["Copy Rectangle As Kill" copy-rectangle-as-kill :help "(copy-rectangle-as-kill START END)\n\nCopy the region-rectangle and save it as the last killed one."]
 ["Yank Rectangle" yank-rectangle :help "(yank-rectangle)\n\nYank the last killed rectangle with upper left corner at point."]
 "--"
 ["Open Rectangle" open-rectangle :help "(open-rectangle START END &amp;optional FILL)\n\nBlank out the region-rectangle, shifting text right.\n\nThe text previously in the region is not overwritten by the blanks,\nbut instead winds up to the right of the rectangle.\n\nWhen called from a program the rectangle's corners are START and END.\nWith a prefix (or a FILL) argument, fill with blanks even if there is\nno text on the right side of the rectangle."]
 ["Close Rectangle" close-rectangle :help "(close-rectangle START END &amp;optional FILL)\n\nDelete all whitespace following a specified column in each line.\nThe left edge of the rectangle specifies the position in each line\nat which whitespace deletion should begin. On each line in the\nrectangle, all contiguous whitespace starting at that column is deleted.\n\nWhen called from a program the rectangle's corners are START and END.\nWith a prefix (or a FILL) argument, also fill too short lines."]
 ["Clear Rectangle" clear-rectangle :help "(clear-rectangle START END &amp;optional FILL)\n\nBlank out the region-rectangle.\nThe text previously in the region is overwritten with blanks.\n\nWhen called from a program the rectangle's corners are START and END.\nWith a prefix (or a FILL) argument, also fill with blanks the parts of the\nrectangle which were empty."]
 "--"
 ["Rectangle Number Lines" rectangle-number-lines :help "(rectangle-number-lines START END START-AT &amp;optional FORMAT)\n\nInsert numbers in front of the region-rectangle.\n\nSTART-AT, if non-nil, should be a number from which to begin\ncounting. FORMAT, if non-nil, should be a format string to pass\nto `format' along with the line count. When called interactively\nwith a prefix argument, prompt for START-AT and FORMAT."]
 "--"
 ["Rectangle Exchange Point And Mark" rectangle-exchange-point-and-mark :help "(rectangle-exchange-point-and-mark &amp;optional ARG)\n\nLike `exchange-point-and-mark' but cycles through the rectangle's corners."]
 "--"
 ["Quit" keyboard-quit :help "(keyboard-quit)\n\nSignal a `quit' condition.\nDuring execution of Lisp code, this character causes a quit directly.\nAt top-level, as an editor command, this simply beeps."])))

(dolist
 (item
 '((begin-rect menu-item "--")
 ["Rectangle Mark Mode" rectangle-mark-mode :style toggle :selected rectangle-mark-mode :help "(rectangle-mark-mode &amp;optional ARG)\n\nToggle the region as rectangular.\nActivates the region if needed. Only lasts until the region is deactivated."]
 (after-rect menu-item "--")))
 (easy-menu-add-item global-map
 '("menu-bar" "edit")
 item "bookmark"))
</pre>

<p>
This snippet does the following
</p>

<ol class="org-ol">
<li>adds a menu entry for <code>rectangle-mark-mode</code> to <code>Edit</code> menu.</li>
<li>adds a menu entry for <code>tabify</code> and <code>untabify</code> commands to <code>Edit</code> menu</li>
<li>adds a menu named <code>Rectangle</code> which gets activated when in <code>rectangle-mark-mode</code>.==</li>
</ol>
</div>
</div>

<div id="outline-container-orgebc37f6" class="outline-2">
<h2 id="step-2-ensure-that-you-have-set-up-the-above-snippet-correctly"><a id="orgebc37f6"></a>Step 2:  Ensure that you have set up the above snippet correctly</h2>
<div class="outline-text-2" id="text-step-2-ensure-that-you-have-set-up-the-above-snippet-correctly">
<p>
Once you restart you Emacs,  you should see menu entries mentioned in previous steps.  See the GIF below for details. If you aren't seeing what you see below, repeat the earlier steps.
</p>

<p>
[<a href="https://emacsnotes.files.wordpress.com/2019/05/rect-overview-2019-05-19.gif">CLICK HERE FOR UNSCALED GIF</a>]
</p>

<p>
<a href="https://emacsnotes.files.wordpress.com/2019/05/rect-overview-2019-05-19.gif?w=740">https://emacsnotes.files.wordpress.com/2019/05/rect-overview-2019-05-19.gif?w=740</a>
</p>

<p>
[<a href="https://emacsnotes.files.wordpress.com/2019/05/rect-overview-2019-05-19.gif">CLICK HERE FOR UNSCALED GIF</a>]
</p>

<p>
Spend some time reviewing the above menus.   The items there give a good overview of  what the <code>rectangle</code> commands do.
</p>
</div>
</div>

<div id="outline-container-org5a5e27d" class="outline-2">
<h2 id="step-3-copy-the-input-table-in-to-an-emacs-buffer"><a id="org5a5e27d"></a>Step 3: Copy the input table in to an Emacs buffer</h2>
<div class="outline-text-2" id="text-step-3-copy-the-input-table-in-to-an-emacs-buffer">
<p>
Copy the input table either from this article, or from here <a href="https://github.com/emacksnotes/emacsnotes.wordpress.com/blob/a382a312e2472937e95624a33f06bb4a9cacb7b6/my-rect-menu.el#L1">(1)</a>.  Note that the table scraped from this article will have spaces (and not tabs), but the one from the snippet will have tabs.
</p>
</div>
</div>

<div id="outline-container-org3b2fec9" class="outline-2">
<h2 id="step-4-do-the-conversion"><a id="org3b2fec9"></a>Step 4:   Do the conversion</h2>
<div class="outline-text-2" id="text-step-4-do-the-conversion">
<p>
See the GIF below for details.  The GIF not only shows how to solve the original problem, but also demonstrates the lesser known facet of <code>rectangle</code> commands:  To indent and de-dent text.
</p>

<p>
[<a href="https://emacsnotes.files.wordpress.com/2019/05/rect-2019-05-19.gif">CLICK HERE FOR UNSCALED GIF</a>]
</p>

<p>
<a href="https://emacsnotes.files.wordpress.com/2019/05/rect-2019-05-19.gif?w=740">https://emacsnotes.files.wordpress.com/2019/05/rect-2019-05-19.gif?w=740</a>
</p>

<p>
[<a href="https://emacsnotes.files.wordpress.com/2019/05/rect-2019-05-19.gif">CLICK HERE FOR UNSCALED GIF</a>]
</p>
</div>
</div>

<div id="outline-container-org98ccacb" class="outline-2">
<h2 id="concluding-words"><a id="org98ccacb"></a>Concluding Words</h2>
<div class="outline-text-2" id="text-concluding-words">
<p>
To many users, <code>rectangle</code> commands may seem like esoteric set of commands that  are of little use in day-to-day editing.   This was also my opinion when I learnt these commands a decade or so ago.  Retrospectively,  I couldn't have been more wrong.  In my experience, I use <code>rectangle</code> commands on a very regular basis.  These commands once mastered, keeps on giving.
</p>
</div>
</div>

<div id="outline-container-org1c5e877" class="outline-2">
<h2 id="appendix"><a id="org1c5e877"></a>Appendix</h2>
<div class="outline-text-2" id="text-appendix">
<p>
Regular users of this blog will remember an earlier article which posed the same problem as this article, but suggested <code>delim-col</code> as a solution. <a href="https://emacsnotes.wordpress.com/2018/09/24/delim-col-a-handy-tool-for-creating-pretty-tables-and-converting-those-to-different-table-formats/">(1)</a> You may want to review that article, and compare and contrast the relative merits and de-merits of <code>delim-col</code> and <code>rectangle</code> based approaches.
</p>
</div>
</div>

</div>
</div>
<div>
        <div class="post-meta">
            <span title="post date" class="post-info">2019-06-13</span>
            <span title="last modification date" class="post-info">2019-06-13</span>
            <span title="tags" class="post-info">:<a href="../../../../../tags/raw">raw</a>:</span>
            <span title="author" class="post-info"><a href="mailto:travis &lt;at&gt; travis-job-b38e90b3-3de6-4029-875e-d675eb67c553">lujun9972</a></span>
        </div>
    <script src="../../../../../media/js/jquery-2.1.3.min.js"></script>
    <script src="../../../../../media/js/md5.min.js"></script>
        <section>
            <div id="gitalk-container"></div>
            <script type="text/javascript">
             var gitalk = new Gitalk({
                 clientID: 'fdcb5d9da3f4acb4862c',
                 clientSecret: 'dd0a16312a206782cb7669dcec5e96874ab48170',
                 repo: 'lujun9972.github.com',
                 owner: 'lujun9972',
                 admin: ['lujun9972'],
                 id: md5(location.pathname),      // Ensure uniqueness and length less than 50
                 distractionFreeMode: false  // Facebook-like distraction free mode
             })
             gitalk.render('gitalk-container')
            </script>
        </section>
    <script src="../../../../../media/js/main.js"></script>
        <script>
         var _hmt = _hmt || [];
         (function() {
             var hm = document.createElement("script");
             hm.src = "https://hm.baidu.com/hm.js?7bac4fd0247f69c27887e0d4e3aee41e";
             var s = document.getElementsByTagName("script")[0]; 
             s.parentNode.insertBefore(hm, s);
         })();
        </script>
    <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 27.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
        <p>
            Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:travis &lt;at&gt; travis-job-b38e90b3-3de6-4029-875e-d675eb67c553">lujun9972</a>
            &nbsp;&nbsp;-&nbsp;&nbsp;
            Powered by <a href="https://github.com/emacs-china/ego" target="_blank">EGO</a><br/>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License" class="center"></a>
            <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
    </div>
            </div>
            <script type="text/javascript"
                    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG">
            </script>
            <script type="text/x-mathjax-config">
             MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });
            </script>
</div>

  </div>
  <!-- https://instant.page/
       Make your site’s pages instant in 1 minute and improve your conversion rate by 1%  -->
  <script src="../../../../../instant.page/1.1.0" type="module" integrity="sha384-EwBObn5QAxP8f09iemwAJljc+sU+eUXeL9vSBw1eNmVarwhKk2F9vBEpaN9rsrtp"></script>
  </body>
</html>
