<!DOCTYPE html>
<html lang="en">
<head>
  <title>Comint: Writing your own Command Interpreter - EMACS-DOCUMENT</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <meta name="author" content="lujun9972" />
  <meta name="keywords" content="raw" />
  <!-- <link rel="stylesheet" href="../../../../../media/css/main.css" type="text/css"/>
       <link rel="stylesheet" href="../../../../../media/css/comment.css" type="text/css"/> -->
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/dark.css'>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
</head>

  <body><div class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="../../../../../">EMACS-DOCUMENT</a></h1>
    <p>=============&gt;集思广益</p>
    <nav class="site-nav">
      <ul class="trigger">
        <li><a href="../../../../../years/">Years</a></li>
        <li><a href="../../../../../authors/">Authors</a></li>
        <li><a href="../../../../../tags/">Tags</a></li>
        <li><a href="../../../../../about/">About</a></li>
        <li><a href="https://github.com/lujun9972/emacs-document">Github</a></li>
        <li><a href="../../../../../rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="https://www.bing.com/search">
      <input type="text" class="field" name="q" id="s" placeholder="Search">
      <input type="hidden" name="as_sitesearch" value="lujun9972.github.io/emacs-document">
    </form>
  </header>
</div>

<div>
<div class="post">
<h1 class="title">Comint: Writing your own Command Interpreter</h1>
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#the-theory">The Theory</a></li>
<li><a href="#writing-a-comint-mode">Writing a Comint Mode</a>
<ul>
<li><a href="#the-comint-template">The Comint Template</a></li>
<li><a href="#extending-cassandra-mode">Extending Cassandra Mode</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
One of the hallmarks of Emacs is its ability to interface with external processes and add to the user experience with the full coterie of Emacs functionality like syntax highlighting, macros, command history, and so on. This functionality has been in Emacs since time immemorial, yet few people make their own command interpreters -- also known as comint -- in Emacs, fearing that it is either really difficult or not possible.
</p>

<p>
It's not surprising people feel this way when you consider how woefully underdocumented this functionality is; the few, scattered references to comint “mode” reveal little, and as a hacker you are forced to use the source, Luke.
</p>

<div id="outline-container-orgc385255" class="outline-2">
<h2 id="the-theory"><a id="orgc385255"></a>The Theory</h2>
<div class="outline-text-2" id="text-the-theory">
<p>
Before I demonstrate how you use comint, a quick briefing -- but rough, as I'm leaving out a few boring steps -- on how it works.
</p>

<p>
At its core, you are spawning a process and either redirecting the stdin, stdout and stderr pipes to Emacs; or you use a pseudo-terminal. The choice between the two is governed by <code>process-connection-type</code>, but it's unlikely that you would ever want to change that manually.
</p>

<p>
The fundamental building blocks for interacting with processes are <code>start-process</code>, for kinda-sorta-asynchronous process calls; and=call-process=, for synchronous process calls.
</p>

<p>
One layer above that and we get to comint with its very pared-down, basic interpreter framework. This is what things like <code>M-x shell</code> and the various REPL modes like Python build on. comint has handles all the nitty-gritty stuff like handling input/output; a command history; basic input/output filter hooks; and so on. In other words, it's the perfect thing to build on if you want something interactive but want more than just what comint has to offer. To use comint is very simple: <code>comint-run</code> takes one argument, <code>PROGRAM</code>, and nothing else; run it with a filepath to your favourite program and watch it fly. For greater configurability, you can use <code>make-comint-in-buffer</code>.
</p>

<p>
<b>Important caveat about pipe redirection:</b> Oftentimes programs will detect that you are redirecting its pipes to a dumb terminal or file and it disables its shell prompt; this is extremely frustrating as not all programs detect that it is running inside Emacs by looking for the signature environment variables Emacs will set: <code>EMACS</code> and <code>INSIDE_EMACS</code>. If that happens you may get lucky and find a flag you can set to force it to run in “interactive” mode -- for example, in Python it's <code>-i</code>.
</p>

<p>
One layer above that and we get to things like <code>M-x shell</code>, which I've talked about before in Running Shells in Emacs: An Overview.
</p>

<p>
And finally, you can list all running/open processes by typing <code>M-x list-processes</code>.
</p>
</div>
</div>

<div id="outline-container-orga7b0d67" class="outline-2">
<h2 id="writing-a-comint-mode"><a id="orga7b0d67"></a>Writing a Comint Mode</h2>
<div class="outline-text-2" id="text-writing-a-comint-mode">
<p>
With that out of the way, let's write some code. I've been playing around with <a href="http://cassandra.apache.org/">Cassandra</a>, the database, and like all respectable databases it has a fine commandline interface -- but no Emacs mode! Oh no!
</p>

<p>
The most important thing about writing a comint mode is that it's very easy to get 80% of the way there, but getting those remaining 20 percentage points is the really difficult part! I'm only doing the 80% here!
</p>

<p>
Let's write one. To start the Cassandra CLI you run the program <code>cassandra-cli</code> and you're presented with output similar to this:
</p>

<pre class="example">
$ ./cassandra-cli
Connected to: "Test Cluster" on 127.0.0.1/9160
Welcome to Cassandra CLI version 1.2.8

Type 'help;' or '?' for help.
Type 'quit;' or 'exit;' to quit.

[default@unknown] 
</pre>

<p>
If you run <code>cassandra-cli</code> with <code>comint-run</code> -- you already have a working, interactive process. It's barebones and simple, but its defaults are reasonable and it will work well enough. If you want to extend it, you have to write your own wrapper function around <code>make-comint-in-buffer</code> and write a major mode also. So let's do just that.
</p>
</div>

<div id="outline-container-org636f0b5" class="outline-3">
<h3 id="the-comint-template"><a id="org636f0b5"></a>The Comint Template</h3>
<div class="outline-text-3" id="text-the-comint-template">
<div class="org-src-container">
<pre class="src src-lisp"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">defvar</span> <span style="color: #7590db;">cassandra-cli-file-path</span> <span style="color: #2d9574;">"/opt/cassandra/bin/cassandra-cli"</span>
 <span style="color: #2aa1ae;">"Path to the program used by `</span><span style="color: #a45bad;">run-cassandra</span><span style="color: #2aa1ae;">'"</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">defvar</span> <span style="color: #7590db;">cassandra-cli-arguments</span> '<span style="color: #bc6ec5;">()</span>
 <span style="color: #2aa1ae;">"Commandline arguments to pass to `</span><span style="color: #a45bad;">cassandra-cli</span><span style="color: #2aa1ae;">'"</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">defvar</span> <span style="color: #7590db;">cassandra-mode-map</span>
 <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">let</span> <span style="color: #2d9574;">(</span><span style="color: #67b11d;">(</span>map <span style="color: #b1951d;">(</span>nconc <span style="color: #4f97d7;">(</span>make-sparse-keymap<span style="color: #4f97d7;">)</span> comint-mode-map<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
 <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">example definition</span>
 <span style="color: #2d9574;">(</span>define-key map <span style="color: #2d9574;">"\t"</span> 'completion-at-point<span style="color: #2d9574;">)</span>
 map<span style="color: #bc6ec5;">)</span>
 <span style="color: #2aa1ae;">"Basic mode map for `</span><span style="color: #a45bad;">run-cassandra</span><span style="color: #2aa1ae;">'"</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">defvar</span> <span style="color: #7590db;">cassandra-prompt-regexp</span> <span style="color: #2d9574;">"^\\(?:\\[[</span><span style="color: #a45bad;">^</span><span style="color: #2d9574;">@]+@[</span><span style="color: #a45bad;">^</span><span style="color: #2d9574;">@]+\\]\\)"</span>
 <span style="color: #2aa1ae;">"Prompt for `</span><span style="color: #a45bad;">run-cassandra</span><span style="color: #2aa1ae;">'."</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

<p>
The first thing we need to do is declare some sensible variables so users can change the settings without having to edit the code. The first one is obvious: we need to store a path to <code>cassandra-cli</code>, the program we want to run.
</p>

<p>
The next variable, <code>cassandra-cli-arguments</code>, holds an (empty) list of commandline arguments.
</p>

<p>
The third, is an empty and currently disused mode map for storing our custom keybindings. It is inherited from <code>comint-mode-map</code>, so we get the same keys exposed in <code>comint-mode</code>.
</p>

<p>
Finally, we have <code>cassandra-prompt-regexp</code>, which holds a regular expression that matches the prompt style Cassandra uses. It so happens that by default it sort-of works already, but it pays to be prepared and it's a good idea to have a regular expression that matches no more than it needs to. Furthermore, as you're probably going to use this code to make your own comint derivatives, you'll probably have to change it anyway.
</p>

<div class="org-src-container">
<pre class="src src-lisp"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">defun</span> <span style="color: #bc6ec5; font-weight: bold;">run-cassandra</span> <span style="color: #bc6ec5;">()</span>
 <span style="color: #2aa1ae;">"Run an inferior instance of `</span><span style="color: #a45bad;">cassandra-cli</span><span style="color: #2aa1ae;">' inside Emacs."</span>
 <span style="color: #bc6ec5;">(</span>interactive<span style="color: #bc6ec5;">)</span>
 <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">let*</span> <span style="color: #2d9574;">(</span><span style="color: #67b11d;">(</span>cassandra-program cassandra-cli-file-path<span style="color: #67b11d;">)</span>
 <span style="color: #67b11d;">(</span>buffer <span style="color: #b1951d;">(</span>comint-check-proc <span style="color: #2d9574;">"Cassandra"</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
 <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">pop to the "*Cassandra*" buffer if the process is dead, the</span>
 <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">buffer is missing or it's got the wrong mode.</span>
 <span style="color: #2d9574;">(</span>pop-to-buffer-same-window
 <span style="color: #67b11d;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #b1951d;">(</span>or buffer <span style="color: #4f97d7;">(</span>not <span style="color: #bc6ec5;">(</span>derived-mode-p 'cassandra-mode<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
 <span style="color: #4f97d7;">(</span>comint-check-proc <span style="color: #bc6ec5;">(</span>current-buffer<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span>
 <span style="color: #b1951d;">(</span>get-buffer-create <span style="color: #4f97d7;">(</span>or buffer <span style="color: #2d9574;">"*Cassandra*"</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span>
 <span style="color: #b1951d;">(</span>current-buffer<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
 <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">create the comint process if there is no buffer.</span>
 <span style="color: #2d9574;">(</span><span style="color: #4f97d7; font-weight: bold;">unless</span> buffer
 <span style="color: #67b11d;">(</span>apply 'make-comint-in-buffer <span style="color: #2d9574;">"Cassandra"</span> buffer
 cassandra-program cassandra-cli-arguments<span style="color: #67b11d;">)</span>
 <span style="color: #67b11d;">(</span>cassandra-mode<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

<p>
This messy pile of code does some basic housekeeping like re-starting the Cassandra process if you're already in the buffer, or create the buffer if it does not exist. Annoyingly there is a dearth of macros to do stuff like this in the comint library; a shame, as it would cut down on the boilerplate code you need to write. The main gist of this function is the <code>apply</code> call taking <code>make-comint-in-buffer</code> as the function. Quite honestly, a direct call to <code>make-comint-in-buffer</code> would suffice, but you lose out on niceties like restartable processes and so on; but if you're writing a comint-derived mode for personal use you may not care about that sort of stuff.
</p>

<div class="org-src-container">
<pre class="src src-lisp"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">defun</span> <span style="color: #bc6ec5; font-weight: bold;">cassandra--initialize</span> <span style="color: #bc6ec5;">()</span>
 <span style="color: #2aa1ae;">"Helper function to initialize Cassandra"</span>
 <span style="color: #bc6ec5;">(</span>setq comint-process-echoes t<span style="color: #bc6ec5;">)</span>
 <span style="color: #bc6ec5;">(</span>setq comint-use-prompt-regexp t<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7;">(</span>define-derived-mode cassandra-mode comint-mode <span style="color: #2d9574;">"Cassandra"</span>
 <span style="color: #2aa1ae;">"Major mode for `</span><span style="color: #a45bad;">run-cassandra</span><span style="color: #2aa1ae;">'.</span>

<span style="color: #2aa1ae;">\\&lt;cassandra-mode-map&gt;"</span>
 nil <span style="color: #2d9574;">"Cassandra"</span>
 <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">this sets up the prompt so it matches things like: [foo@bar]</span>
 <span style="color: #bc6ec5;">(</span>setq comint-prompt-regexp cassandra-prompt-regexp<span style="color: #bc6ec5;">)</span>
 <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">this makes it read only; a contentious subject as some prefer the</span>
 <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">buffer to be overwritable.</span>
 <span style="color: #bc6ec5;">(</span>setq comint-prompt-read-only t<span style="color: #bc6ec5;">)</span>
 <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">this makes it so commands like M-{ and M-} work.</span>
 <span style="color: #bc6ec5;">(</span>set <span style="color: #2d9574;">(</span>make-local-variable 'paragraph-separate<span style="color: #2d9574;">)</span> <span style="color: #2d9574;">"\\'"</span><span style="color: #bc6ec5;">)</span>
 <span style="color: #bc6ec5;">(</span>set <span style="color: #2d9574;">(</span>make-local-variable 'font-lock-defaults<span style="color: #2d9574;">)</span> '<span style="color: #2d9574;">(</span>cassandra-font-lock-keywords t<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
 <span style="color: #bc6ec5;">(</span>set <span style="color: #2d9574;">(</span>make-local-variable 'paragraph-start<span style="color: #2d9574;">)</span> cassandra-prompt-regexp<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">this has to be done in a hook. grumble grumble.</span>
<span style="color: #4f97d7;">(</span>add-hook 'cassandra-mode-hook 'cassandra--initialize<span style="color: #4f97d7;">)</span>
</pre>
</div>

<p>
And finally, we have our major mode definition. Observe that we derive from <code>comint-mode</code>. I overwrite the default <code>comint-prompt-regexp</code> with our own, and I force the prompt to be read only also. I add a mode hook and set <code>comint-process-echoes</code> to <code>t</code> to avoid duplicating the input we write on the screen. And finally, I tweak the paragraph settings so you can navigate between each prompt with <code>M-{</code> and <code>M-}</code>.
</p>

<p>
And.. that's more or less it for the template. It's trivial to tweak it to your own needs and it's a good place to start.
</p>

<p>
Let's add some cool functionality to our cassandra-mode: basic syntax highlighting.
</p>
</div>
</div>

<div id="outline-container-org1c43114" class="outline-3">
<h3 id="extending-cassandra-mode"><a id="org1c43114"></a>Extending Cassandra Mode</h3>
<div class="outline-text-3" id="text-extending-cassandra-mode">
<p>
The first thing I want to do is add simple syntax highlighting for the commands you get when you run <code>help;</code>.
</p>

<p>
We need to think about some simple rules we can come up with that will highlight stuff. This is the hard bit: coming up with a regular expression for non-regular languages is nigh-on impossible to get right; especially not when you're doing it for a commandline application that spits out all manner of output.
</p>

<p>
Before we do that though, let's augment our major mode to support syntax highlighting (which is actually known as font locking in Emacs parlance.)
</p>

<div class="org-src-container">
<pre class="src src-lisp"><span style="color: #4f97d7;">(</span>set <span style="color: #bc6ec5;">(</span>make-local-variable 'font-lock-defaults<span style="color: #bc6ec5;">)</span> '<span style="color: #bc6ec5;">(</span>cassandra-font-lock-keywords t<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

<p>
Add this form to the body of the major mode (next to the existing setq calls) and then add the following form to the top of the file, to hold our font lock rules:
</p>

<div class="org-src-container">
<pre class="src src-lisp"><span style="color: #4f97d7;">(</span>defconst cassandra-keywords
 '<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"assume"</span> <span style="color: #2d9574;">"connect"</span> <span style="color: #2d9574;">"consistencylevel"</span> <span style="color: #2d9574;">"count"</span> <span style="color: #2d9574;">"create column family"</span>
 <span style="color: #2d9574;">"create keyspace"</span> <span style="color: #2d9574;">"del"</span> <span style="color: #2d9574;">"decr"</span> <span style="color: #2d9574;">"describe cluster"</span> <span style="color: #2d9574;">"describe"</span>
 <span style="color: #2d9574;">"drop column family"</span> <span style="color: #2d9574;">"drop keyspace"</span> <span style="color: #2d9574;">"drop index"</span> <span style="color: #2d9574;">"get"</span> <span style="color: #2d9574;">"incr"</span> <span style="color: #2d9574;">"list"</span>
 <span style="color: #2d9574;">"set"</span> <span style="color: #2d9574;">"show api version"</span> <span style="color: #2d9574;">"show cluster name"</span> <span style="color: #2d9574;">"show keyspaces"</span>
 <span style="color: #2d9574;">"show schema"</span> <span style="color: #2d9574;">"truncate"</span> <span style="color: #2d9574;">"update column family"</span> <span style="color: #2d9574;">"update keyspace"</span> <span style="color: #2d9574;">"use"</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">defvar</span> <span style="color: #7590db;">cassandra-font-lock-keywords</span>
 <span style="color: #bc6ec5;">(</span>list
 <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">highlight all the reserved commands.</span>
 `<span style="color: #2d9574;">(</span>,<span style="color: #67b11d;">(</span>concat <span style="color: #2d9574;">"\\_&lt;"</span> <span style="color: #b1951d;">(</span>regexp-opt cassandra-keywords<span style="color: #b1951d;">)</span> <span style="color: #2d9574;">"\\_&gt;"</span><span style="color: #67b11d;">)</span> . font-lock-keyword-face<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
 <span style="color: #2aa1ae;">"Additional expressions to highlight in `</span><span style="color: #a45bad;">cassandra-mode</span><span style="color: #2aa1ae;">'."</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

<p>
There is one font lock rule: it highlights all matching keywords that I extracted from the <code>help;</code> command.
</p>

<p>
comint exposes a set of filter function variables that're triggered and run (in order, it's a list) when certain conditions are met:
</p>

<p>
<b>Variable Name</b>
</p>

<p>
<b>Purpose</b>
</p>

<p>
<code>comint-dynamic-complete-functions</code>
</p>

<p>
List of functions called to perform completion.
</p>

<p>
<code>comint-input-filter-functions</code>
</p>

<p>
Abnormal hook run before input is sent to the process.
</p>

<p>
<code>comint-output-filter-functions</code>
</p>

<p>
Functions to call after output is inserted into the buffer.
</p>

<p>
<code>comint-preoutput-filter-functions</code>
</p>

<p>
List of functions to call before inserting Comint output into the buffer.
</p>

<p>
<code>comint-redirect-filter-functions</code>
</p>

<p>
List of functions to call before inserting redirected process output.
</p>

<p>
<code>comint-redirect-original-filter-function</code>
</p>

<p>
The process filter that was in place when redirection is started
</p>

<p>
Another useful variable is <code>comint-input-sender</code>, which lets you alter the input string mid-stream. Annoyingly its name is inconsistent with the filter functions above.
</p>

<p>
You can use them to control how input and output is processed and interpreted mid-stream.
</p>

<p>
And there you go: a simple, comint-enabled Cassandra CLI in Emacs.
</p>
</div>
</div>
</div>

</div>
</div>
<div>
        <div class="post-meta">
            <span title="post date" class="post-info">2018-10-24</span>
            <span title="last modification date" class="post-info">2018-10-24</span>
            <span title="tags" class="post-info">:<a href="../../../../../tags/raw">raw</a>:</span>
            <span title="author" class="post-info"><a href="mailto:lujun9972 &lt;at&gt; T520">lujun9972</a></span>
        </div>
    <script src="../../../../../media/js/jquery-2.1.3.min.js"></script>
    <script src="../../../../../media/js/md5.min.js"></script>
        <section>
            <div id="gitalk-container"></div>
            <script type="text/javascript">
             var gitalk = new Gitalk({
                 clientID: 'fdcb5d9da3f4acb4862c',
                 clientSecret: 'dd0a16312a206782cb7669dcec5e96874ab48170',
                 repo: 'lujun9972.github.com',
                 owner: 'lujun9972',
                 admin: ['lujun9972'],
                 id: md5(location.pathname),      // Ensure uniqueness and length less than 50
                 distractionFreeMode: false  // Facebook-like distraction free mode
             })
             gitalk.render('gitalk-container')
            </script>
        </section>
    <script src="../../../../../media/js/main.js"></script>
    <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 26.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
        <p>
            Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:lujun9972 &lt;at&gt; T520">lujun9972</a>
            &nbsp;&nbsp;-&nbsp;&nbsp;
            Powered by <a href="https://github.com/emacs-china/ego" target="_blank">EGO</a><br/>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License" class="center"></a>
            <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
    </div>
            </div>
            <script type="text/javascript"
                    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG">
            </script>
            <script type="text/x-mathjax-config">
             MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });
            </script>
</div>

  </div>
  <!-- https://instant.page/
       Make your site’s pages instant in 1 minute and improve your conversion rate by 1%  -->
  <script src="../../../../../instant.page/1.1.0" type="module" integrity="sha384-EwBObn5QAxP8f09iemwAJljc+sU+eUXeL9vSBw1eNmVarwhKk2F9vBEpaN9rsrtp"></script>
  </body>
</html>
