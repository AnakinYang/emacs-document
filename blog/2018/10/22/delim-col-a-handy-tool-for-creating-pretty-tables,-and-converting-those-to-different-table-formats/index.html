<!DOCTYPE html>
<html lang="en">
<head>
  <title>Delim Col: A handy tool for creating pretty tables, and converting those to different table formats - EMACS-DOCUMENT</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <meta name="author" content="lujun9972" />
  <meta name="keywords" content="raw" />
  <style>
   #ds-thread #ds-reset .ds-comment-body p {color: #ffffff;}
   #ds-thread #ds-reset .ds-comment-body p a {color: #ff0;}
   #ds-thread #ds-reset .ds-comment-body p a:hover {color: #0ff;}
   #disqus_thread a {color: #00ffff;}
  </style>
  <link rel="stylesheet" href="https://lujun9972.github.io/emacs-document/media/css/main.css" type="text/css"/>
  <link rel="stylesheet" href="https://lujun9972.github.io/emacs-document/media/css/comment.css" type="text/css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
</head>

  <body><div class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="https://lujun9972.github.io/emacs-document/">EMACS-DOCUMENT</a></h1>
    <p>=============&gt;集思广益</p>
    <nav class="site-nav">
      <div class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z" fill="#ffff00"/>
          <path d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z" fill="#ffff00"/>
          <path d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z" fill="#ffff00"/>
        </svg>
      </div>
      <ul class="trigger">
        <li><a href="https://lujun9972.github.io/emacs-document/years/">Years</a></li>
        <li><a href="https://lujun9972.github.io/emacs-document/authors/">Authors</a></li>
        <li><a href="https://lujun9972.github.io/emacs-document/tags/">Tags</a></li>
        <li><a href="https://lujun9972.github.io/emacs-document/about/">About</a></li>
        <li><a href="https://github.com/lujun9972/emacs-document">Github</a></li>
        <li><a href="https://lujun9972.github.io/emacs-document/rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="http://www.google.com/search">
      <input type="text" class="field" name="q" id="s" placeholder="Search">
      <input type="hidden" name="as_sitesearch" value="lujun9972.github.io/emacs-document">
    </form>
  </header>
</div>

<div>
<div class="post">
<h1 class="title">Delim Col: A handy tool for creating pretty tables, and converting those to different table formats</h1>
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#a-problem-and-a-solution">A Problem ... and a Solution</a></li>
<li><a href="#what-does-delim-col-do">What does <code>delim-col</code> do?</a></li>
<li><a href="#what-does-delim-col-not-do">What does <code>delim-col</code> NOT do?</a></li>
<li><a href="#step-1-create-a-menu">Step 1: Create a menu</a></li>
<li><a href="#step-2-ensure-that-you-have-the-extra-tools-submenu">Step 2: Ensure that you have the <code>Extra Tools</code> submenu</a></li>
<li><a href="#step-3-copy-paste-the-table-in-to-an-emacs-buffer">Step 3: Copy-paste the table in to an Emacs buffer</a></li>
<li><a href="#org78f8d91">Step 4: Mark the region or rectangle</a></li>
<li><a href="#step-5-do-the-conversion">Step 5: Do the conversion</a></li>
<li><a href="#concluding-words">Concluding Words</a></li>
<li><a href="#appendix">Appendix</a></li>
</ul>
</div>
</div>
<div id="outline-container-org64103fa" class="outline-2">
<h2 id="a-problem-and-a-solution">A Problem ... and a Solution</h2>
<div class="outline-text-2" id="text-a-problem-and-a-solution">
<p>
You are given the following table <a href="https://github.com/emacs-mirror/emacs/blob/75386e305f388ff51bc8cf9945f52c29c14427cd/lisp/delim-col.el#L35">1</a>
</p>

<pre class="example">
a b c d
aaaa bb ccc ddddd
aaa bbb cccc dddd
aa bb ccccccc ddd
</pre>

<p>
How would you generate this table
</p>

<pre class="example">
[ a , b , c , d ]
[ aaaa, bb , ccc , ddddd ]
[ aaa , bbb, cccc , dddd ]
[ aa , bb , ccccccc, ddd ]
</pre>

<p>
and this table
</p>

<pre class="example">
a [ b , c ] d
aaaa [ bb , ccc ] ddddd
aaa [ bbb, cccc ] dddd
aa [ bb , ccccccc ] ddd
</pre>

<p>
and this table
</p>

<pre class="example">
[ &lt;a&gt; , &lt;b&gt; , &lt;c&gt; , &lt;d&gt; ]
[ &lt;aaaa&gt;, &lt;bb&gt; , &lt;ccc&gt; , &lt;ddddd&gt; ]
[ &lt;aaa&gt; , &lt;bbb&gt;, &lt;cccc&gt; , &lt;dddd&gt; ]
[ &lt;aa&gt; , &lt;bb&gt; , &lt;ccccccc&gt;, &lt;ddd&gt; ]
</pre>

<p>
and this table
</p>

<pre class="example">
a [ &lt;b&gt; , &lt;c&gt; ] d
aaaa [ &lt;bb&gt; , &lt;ccc&gt; ] ddddd
aaa [ &lt;bbb&gt;, &lt;cccc&gt; ] dddd
aa [ &lt;bb&gt; , &lt;ccccccc&gt; ] ddd
</pre>

<p>
A answer is you use one of the Emacs' built-in library called <code>delim-col</code><a href="https://github.com/emacs-mirror/emacs/blob/master/lisp/delim-col.el">1</a>.
</p>
</div>
</div>

<div id="outline-container-orgf7d1a57" class="outline-2">
<h2 id="what-does-delim-col-do">What does <code>delim-col</code> do?</h2>
<div class="outline-text-2" id="text-what-does-delim-col-do">
<p>
The <code>delim-col</code> package describes itself as
</p>

<blockquote>
<p>
<code>delim-col</code> helps to prettify columns in a text region or rectangle
</p>
</blockquote>

<p>
In my opinion, the above description doesn't tell much about what it offers a user. Instead, I would describe the package as
</p>

<blockquote>
<p>
<code>delim-col</code> creates pretty tables from a text region and helps convert those tables in to different table formats like <code>TSV</code><a href="https://en.wikipedia.org/wiki/Tab-separated_values">1</a>, <code>CSV</code><a href="https://en.wikipedia.org/wiki/Comma-separated_values">1</a>, <code>Org</code><a href="https://www.gnu.org/software/emacs/manual/html_node/org/Built_002din-table-editor.html#Built_002din-table-editor">1</a>, <code>LaTeX</code><a href="https://en.wikibooks.org/wiki/LaTeX/Mathematics#Matrices_and_arrays">1</a>, <code>GFM</code><a href="https://docs.gitlab.com/ee/user/markdown.html#tables">1</a>, <a href="https://help.github.com/articles/organizing-information-with-tables/">2</a>   or any other makeshift format that you may come up with.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgb43b60a" class="outline-2">
<h2 id="what-does-delim-col-not-do">What does <code>delim-col</code> NOT do?</h2>
<div class="outline-text-2" id="text-what-does-delim-col-not-do">
<p>
In doing the above conversions, you would expect that <code>delim-col</code> prompts you for all these parameters
</p>

<ol class="org-ol">
<li>the regexp which separates each column</li>
<li>a string to be inserted before (and after) each column</li>
<li>a string to be inserted between each column</li>
<li>a string to be inserted at the beginning (and end of) each row</li>
</ol>

<p>
and a way to add padding.
</p>

<p>
Unfortunately, the above parameters are hard-coded and aren't gathered from the user on each run.
</p>
</div>
</div>

<div id="outline-container-orgaf60e5d" class="outline-2">
<h2 id="step-1-create-a-menu">Step 1: Create a menu</h2>
<div class="outline-text-2" id="text-step-1-create-a-menu">
<p>
Copy the <code>Emacs Lisp</code> snippet<a href="https://raw.githubusercontent.com/emacksnotes/emacsnotes.wordpress.com/master/my-delim-col-menu.el">1</a> below to your <code>.emacs</code> and restart your <code>Emacs</code>.
</p>

<p>
This snippet does the following
</p>

<ol class="org-ol">
<li>modifies the commands <code>delimit-columns-region</code> and <code>delimit-columns-rectangle</code> so that they prompt you for input on every run.</li>
<li>adds a sub-menu named <code>Extra Tools</code> to the menu. To this sub-menu, it adds another sub-menu named <code>Delimit Columns in ...</code>.</li>
</ol>

<pre class="example">
(defun my-delimits-column-region
 (orig-fun &amp;rest args)
 (let
 ((delimit-columns-separator
 (read-regexp
 (format "%s (%s): " "Specify the regexp which separates each column" delimit-columns-separator)
 (list delimit-columns-separator)))
 (delimit-columns-before
 (read-string
 (format "%s (%s): " "Specify a string to be inserted before each column" delimit-columns-before)
 nil nil delimit-columns-before))
 (delimit-columns-after
 (read-string
 (format "%s (%s): " "Specify a string to be inserted after each column" delimit-columns-after)
 nil nil delimit-columns-after))
 (delimit-columns-str-separator
 (read-string
 (format "%s (%s): " "Specify a string to be inserted between each column" delimit-columns-str-separator)
 nil nil delimit-columns-str-separator))
 (delimit-columns-str-before
 (read-string
 (format "%s (%s): " "Specify a string to be inserted before the first column" delimit-columns-str-before)
 nil nil delimit-columns-str-before))
 (delimit-columns-str-after
 (read-string
 (format "%s (%s): " "Specify a string to be inserted after the last column" delimit-columns-str-after)
 nil nil delimit-columns-str-after))
 (delimit-columns-format
 (let*
 ((choices
 '(("Align Columns" . t)
 ("No Formatting")
 ("Align Separators" . separator)
 ("Pad Columns" . padding)))
 (default-choice
 (car
 (rassoc delimit-columns-format choices)))
 (choice
 (completing-read
 (format "%s (%s): " "Specify how to format columns" default-choice)
 choices nil t nil nil default-choice)))
 (message "%s" choice)
 (assoc-default choice choices))))
 (apply orig-fun args)))

(advice-add 'delimit-columns-region :around #'my-delimits-column-region)
(advice-add 'delimit-columns-rectangle :around #'my-delimits-column-region)

(define-key-after global-map
 [menu-bar extra-tools]
 (cons "Extra Tools"
 (easy-menu-create-menu "Extra Tools" nil))
 'tools)

(easy-menu-define my-delim-col-menu nil "Menu for Delim Col"
 '("Delimit Columns in ..."
 ["Region" delimit-columns-region :help "Prettify all columns in a text region"]
 ["Rectangle" delimit-columns-rectangle :help "Prettify all columns in a text rectangle"]
 "---"
 ["Customize" delimit-columns-customize :help "Customization of `columns' group"]))

(easy-menu-add-item (current-global-map) '("menu-bar" "extra-tools") my-delim-col-menu)
</pre>
</div>
</div>

<div id="outline-container-org2f91648" class="outline-2">
<h2 id="step-2-ensure-that-you-have-the-extra-tools-submenu">Step 2: Ensure that you have the <code>Extra Tools</code> submenu</h2>
<div class="outline-text-2" id="text-step-2-ensure-that-you-have-the-extra-tools-submenu">
<p>
Once you restart your Emacs, you would see an entry for <code>Extra Tools</code> in the menu bar.  If you aren't seeing this submenu, repeat the previous step.
</p>
</div>
</div>

<div id="outline-container-org5843a9f" class="outline-2">
<h2 id="step-3-copy-paste-the-table-in-to-an-emacs-buffer">Step 3: Copy-paste the table in to an Emacs buffer</h2>
<div class="outline-text-2" id="text-step-3-copy-paste-the-table-in-to-an-emacs-buffer">
<p>
Copy-paste the input table either from this article or from the <code>delim-col</code> library <a href="https://github.com/emacs-mirror/emacs/blob/75386e305f388ff51bc8cf9945f52c29c14427cd/lisp/delim-col.el#L35">1</a>.  It is important to note that the table scraped from this article will have spaces (and not tabs), but the one from <code>delim-col</code> will have tabs.
</p>
</div>
</div>

<div id="outline-container-org78f8d91" class="outline-2">
<h2 id="org78f8d91">Step 4: Mark the region or rectangle</h2>
</div>


<div id="outline-container-orgbd6180c" class="outline-2">
<h2 id="step-5-do-the-conversion">Step 5: Do the conversion</h2>
<div class="outline-text-2" id="text-step-5-do-the-conversion">
<p>
<a href="https://emacsnotes.files.wordpress.com/2018/09/screenshot-from-2018-09-23-22-08-05.png?w=740">https://emacsnotes.files.wordpress.com/2018/09/screenshot-from-2018-09-23-22-08-05.png?w=740</a>
</p>

<p>
Emacs will prompt you for further input.   Key in the parameters as you deem fit.
</p>

<p>
The prompt string shows the factory default settings, and they are enclosed within  <code>()</code>. You can press <code>Enter</code> to accept the factory settings.
</p>

<p>
When copy-pasting the original table from this web article in to your Emacs, the table will contain spaces. So, when prompted with <code>Specify the regexp which separates each column</code> use  <code> +</code> (i.e. <code>SPC+</code>).
</p>

<p>
When prompted with <code>Specify how to format columns</code> you can press <code>TAB</code> , and choose among the candidates shown.  As you see from screenshot below, for my own run, I chose <code>Align Separators</code>.
</p>

<p>
<a href="https://emacsnotes.files.wordpress.com/2018/09/screenshot-from-2018-09-23-22-28-54.png?w=740">https://emacsnotes.files.wordpress.com/2018/09/screenshot-from-2018-09-23-22-28-54.png?w=740</a>
</p>

<p>
Here is the output I get at the end of one such run.
</p>

<p>
<a href="https://emacsnotes.files.wordpress.com/2018/09/screenshot-from-2018-09-23-22-33-24.png?w=740">https://emacsnotes.files.wordpress.com/2018/09/screenshot-from-2018-09-23-22-33-24.png?w=740</a>
</p>
</div>
</div>

<div id="outline-container-orge4119b0" class="outline-2">
<h2 id="concluding-words">Concluding Words</h2>
<div class="outline-text-2" id="text-concluding-words">
<p>
You can pose the original problem to experienced users of Emacs.  Each user will have his own suggestions.  Most users will suggest rectangle commands<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles.html">1</a>.  Some users will suggest that you use <code>org-table-convert-region</code><a href="https://github.com/emacs-mirror/emacs/blob/d0e2a341dd9a9a365fd311748df024ecb25b70ec/lisp/org/org-table.el#L579">1</a> to convert the original table in to <code>Org</code>-format table<a href="https://www.gnu.org/software/emacs/manual/html_node/org/Built_002din-table-editor.html#Built_002din-table-editor">1</a>, and create a makeshift code based on <code>orgtbl-to-generic</code> <a href="https://github.com/emacs-mirror/emacs/blob/d0e2a341dd9a9a365fd311748df024ecb25b70ec/lisp/org/org-table.el#L4798">1</a>.  (I bet, no user will suggest <code>delim-col</code> because it is a package which lacks an entry in the user manual.) None of the solutions you hear have the simplicity and quickness as <code>delim-col</code>.  In my opinion,  <code>delim-col</code> is a very useful tool to have in your toolkit.
</p>
</div>
</div>

<div id="outline-container-orgff15f8d" class="outline-2">
<h2 id="appendix">Appendix</h2>
<div class="outline-text-2" id="text-appendix">
<p>
This article on <code>delim-col</code> was created as an aid to one of my friends<a href="https://www.reddit.com/r/emacs/comments/9i2o7r/quoting_two_columns_of_text_using_macros/">1</a>, a newcomer to Emacs. She wanted to convert a table scraped from web<a href="https://useast.ensembl.org/info/genome/stable_ids/prefixes.html">1</a> in to a Python dictionary<a href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries">1</a>.
</p>

<p>
Specifically, she wanted to convert an HTML  table that looks like this
</p>

<p>
<a href="https://emacsnotes.files.wordpress.com/2018/09/screenshot-2018-9-23-ensembl-stable-id-prefixes.png?w=740">https://emacsnotes.files.wordpress.com/2018/09/screenshot-2018-9-23-ensembl-stable-id-prefixes.png?w=740</a>
</p>

<p>
in to a <code>python</code> dictionary that looks like this
</p>

<p>
<a href="https://emacsnotes.files.wordpress.com/2018/09/screenshot-from-2018-09-24-00-04-58.png?w=740">https://emacsnotes.files.wordpress.com/2018/09/screenshot-from-2018-09-24-00-04-58.png?w=740</a>
</p>

<p>
With a little imagination, it is easy to see how she can use <code>delim-col</code> to achieve much of what she wants.
</p>

<p>
That said, I hear those of you asking me “What if the second column in the friend's table happened to be numeric, and she didn't want the numeric fields quoted ...”.  In this case, I suppose, <code>delim-col</code> doesn't have anything immediate to offer, and I am afraid, the friend needs to switch to other means.
</p>
</div>
</div>

</div>
</div>
<div>
        <div class="post-meta">
            <span title="post date" class="post-info">2018-10-22</span>
            <span title="last modification date" class="post-info">2018-10-22</span>
            <span title="tags" class="post-info">:<a href="https://lujun9972.github.io/emacs-document/tags/raw">raw</a>:</span>
            <span title="author" class="post-info"><a href="mailto:lujun9972 &lt;at&gt; T430S">lujun9972</a></span>
        </div>
    <script src="https://lujun9972.github.io/emacs-document/media/js/jquery-2.1.3.min.js"></script>
        <section>
            <h1>Comments</h1>
            <div id="comment-wrap">
                    <a class="disqus_label">使用 Disqus 评论</a>
    </ul>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
         //var disqus_developer = 1;
         var preempt_signal=false;
         var disqus_identifier = "/blog/2018/10/22/delim-col-a-handy-tool-for-creating-pretty-tables,-and-converting-those-to-different-table-formats/";
         var disqus_url = "https://lujun9972.github.io/emacs-document/blog/2018/10/22/delim-col-a-handy-tool-for-creating-pretty-tables,-and-converting-those-to-different-table-formats/";
         var disqus_shortname = 'emacs-document';
         /* * * DON'T EDIT BELOW THIS LINE * * */
         (function() {
             var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
             dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
             $('#disqus_thread').css('display','none');
         })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    <script>
     /* comments */
     var ego_disqus_thread=$('#disqus_thread');
     var ego_ds_label=$('.ds-thread');
     $('.disqus_label').click(function(){
         ego_disqus_thread.show();
         ego_ds_label.hide();
     });
     $('.ds-label').click(function(){
         ego_disqus_thread.hide();
         ego_ds_label.show();
     });
    </script>
        </section>
    <script src="https://lujun9972.github.io/emacs-document/media/js/main.js"></script>
    <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 26.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
        <p>
            Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:lujun9972 &lt;at&gt; T430S">lujun9972</a>
            &nbsp;&nbsp;-&nbsp;&nbsp;
            Powered by <a href="https://github.com/emacs-china/ego" target="_blank">EGO</a><br/>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License" class="center"></a>
            <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
    </div>
            </div>
            <script type="text/javascript"
                    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG">
            </script>
            <script type="text/x-mathjax-config">
             MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });
            </script>
</div>

  </div>
  <!-- https://instant.page/
       Make your site’s pages instant in 1 minute and improve your conversion rate by 1%  -->
  <script src="https://lujun9972.github.io/emacs-document//instant.page/1.1.0" type="module" integrity="sha384-EwBObn5QAxP8f09iemwAJljc+sU+eUXeL9vSBw1eNmVarwhKk2F9vBEpaN9rsrtp"></script>
  </body>
</html>
