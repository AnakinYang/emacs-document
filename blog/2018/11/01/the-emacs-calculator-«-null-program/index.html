<!DOCTYPE html>
<html lang="en">
<head>
  <title>The Emacs Calculator « null program - EMACS-DOCUMENT</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <meta name="author" content="lujun9972" />
  <meta name="keywords" content="raw" />
  <style>
   #ds-thread #ds-reset .ds-comment-body p {color: #ffffff;}
   #ds-thread #ds-reset .ds-comment-body p a {color: #ff0;}
   #ds-thread #ds-reset .ds-comment-body p a:hover {color: #0ff;}
   #disqus_thread a {color: #00ffff;}
  </style>
  <link rel="stylesheet" href="/media/css/main.css" type="text/css"/>
  <link rel="stylesheet" href="/media/css/comment.css" type="text/css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
</head>

  <body><div class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="/">EMACS-DOCUMENT</a></h1>
    <p>=============&gt;随便,谢谢</p>
    <nav class="site-nav">
      <div class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z" fill="#ffff00"/>
          <path d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z" fill="#ffff00"/>
          <path d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z" fill="#ffff00"/>
        </svg>
      </div>
      <ul class="trigger">
        <li><a href="/years/">Years</a></li>
        <li><a href="/authors/">Authors</a></li>
        <li><a href="/tags/">Tags</a></li>
        <li><a href="/about/">About</a></li>
        <li><a href="https://github.com/lujun9972/emacs-document.git">Github</a></li>
        <li><a href="/rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="http://www.google.com/search">
      <input type="text" class="field" name="q" id="s" placeholder="Search">
      <input type="hidden" name="as_sitesearch" value="lujun9972.github.io/emacs-document">
    </form>
  </header>
</div>

<div>
<div class="post">
<h1 class="title">The Emacs Calculator « null program</h1>
<p>
Did you know that <a href="http://www.gnu.org/software/emacs/calc.html">Emacs comes with a
calculator</a>? Woop-dee-doo! Call the presses! Wow, a whole
calculator! Sounds a bit lame, right?
</p>

<p>
Actually, it's much more than just a simple calculator. It's a <a href="http://en.wikipedia.org/wiki/Computer_algebra_system">computer
algebra system</a>! It is officially called a calculator, which isn't
fair. It's an understatement, and I am sure has caused many people to
overlook it. I finally ran into it during a thorough (re)reading of
the Emacs manuals and almost skipped over it myself.
</p>

<p>
Ever see that demonstration by Will Wright for the game <i>Spore</i>
several years ago? The player starts as a single-cell organism and
evolves into a civilization with interstellar presence. When he
started the demo he showed a cell through what looked like a
microscope. No one had any idea yet what the game was about, so every
time he increased the scope, from bacteria to animal, animal to
civilization, civilization to space travel, interplanetary travel to
interstellar travel, there was a huge reaction from the audience. It
was like those infomercials: "But that's not all!!!"
</p>

<p>
As I made my way through the Emacs calc manual I was continually
amazed by its power, with a similar constant increase in scope. Each
new page was almost saying, "But that's not all!!!"
</p>

<p>
Like an infomercial I'm going to run through some of its features. See
the calc manual for a real thorough introduction. It has practice
exercises that shows some gotchas and interesting feature
interactions.
</p>

<p>
Fire it up with <code>C-x 0_sync_master.sh 1_add_new_article_manual.sh 1_add_new_article_newspaper.sh 2_start_translating.sh 3_continue_the_work.sh 4_finish.sh 5_pause.sh base.sh parse_url_by_manual.sh parse_url_by_newspaper.py parse_url_by_newspaper.sh project.cfg reformat.sh texput.log urls_checker.sh c</code> or <code>M-x calc</code>. There
will be two new windows (Emacs windows, that is), one with the
calculator and the other with usage history (the "trail").
</p>

<p>
First of all, the calculator operates on a stack and so its basic use
is done with RPN. The stack builds vertically, downwards. Type in
numbers and hit enter to push them onto the stack. Operators can be
typed right after the number, so no need to hit enter all the
time. Because negative (<code>-</code>) is reserved for subtraction an
underscore <code>_</code> is used to type a negative number. An
example stack with 3, 4, and 10,
</p>

<pre class="example">
3: 3
2: 4
1: 10
 .
</pre>

<p>
10 is at the "top" of the stack (indicated by the "1:"), so if we type
a <code>*</code> the top two elements are multiplied. Like so,
</p>

<pre class="example">
2: 3
1: 40
 .
</pre>

<p>
The calculator has no limitations on the size of integers, so you work
with large numbers without losing precision. For example, we'll
take <code>2^200</code>.
</p>

<pre class="example">
2: 2
1: 200
 .
</pre>

<p>
Apply the <code>^</code> operator,
</p>

<pre class="example">
1: 1606938044258990275541962092341162602522202993782792835301376
 .
</pre>

<p>
But that's not all!!! It has a complex number type, which is entered
in pairs (real, imaginary) with parenthesis. They can be operated on
like any other number. Take <code>-1 + 2i</code> minus <code>4 + 2i</code>,
</p>

<pre class="example">
2: (-1, 2)
1: (4, 2)
 .
</pre>

<p>
Subtract with <code>-</code>,
</p>

<pre class="example">
1: -5
 .
</pre>

<p>
Then take the square root of that using <code>Q</code>, the square
root function.
</p>

<pre class="example">
1: (0., 2.2360679775)
 .
</pre>

<p>
We can set the calculator's precision with <code>p</code>. The default
is 12 places, showing here <code>1 / 7</code>.
</p>

<pre class="example">
1: 0.142857142857
 .
</pre>

<p>
If we adjust the precision to 50 and do it again,
</p>

<pre class="example">
2: 0.142857142857
1: 0.14285714285714285714285714285714285714285714285714
 .
</pre>

<p>
Numbers can be displayed in various notations, too, like fixed-point,
scientific notation, and engineering notation. It will switch between
these without losing any information (the stored form is separate from
the displayed form).
</p>

<p>
But that's not all!!! We can represent rational numbers precisely with
ratios. These are entered with a <code>:</code>. Push
on <code>1/7</code>, <code>3/14</code>, and <code>17/29</code>,
</p>

<pre class="example">
3: 1:7
2: 3:13
1: 17:29
 .
</pre>

<p>
And multiply them all together, which displays in the lowest form,
</p>

<pre class="example">
1: 51:2842
 .
</pre>

<p>
There is a mode for working in these automatically.
</p>

<p>
But that's not all!!! We can change the radix. To enter a number with
a different radix, which prefix it with the radix and a
<code>#</code>. Here is how we enter 29 in base-2,
</p>

<pre class="example">
2#11101
</pre>

<p>
We can change the display radix with <code>d r</code>. With 29 on the
stack, here's base-4,
</p>

<pre class="example">
1: 4#131
 .
</pre>

<p>
Base-16,
</p>

<pre class="example">
1: 16#1D
 .
</pre>

<p>
Base-36,
</p>

<pre class="example">
1: 36#T
 .
</pre>

<p>
But that's not all!!! We can enter algebraic expressions onto the
stack with apostrophe, <code>'</code>. Symbols can be entered as part
of the expression. Note: these expressions are not entered in RPN.
</p>

<pre class="example">
1: a^3 + a^2 b / c d - a / b
 .
</pre>

<p>
There is a "big" mode (<code>d B</code>) for easier reading,
</p>

<pre class="example">
 2
 3 a b a
1: a + ---- - -
 c d b

 .
</pre>

<p>
We can assign values to variables to have the expression evaluated. If
we assign <code>a</code> to 10 and use the "evaluates-to" operator,
</p>

<pre class="example">
 2
 3 a b a 100 b 10
1: a + ---- - - =&gt; 1000 + ----- - --
 c d b c d b

 .
</pre>

<p>
But that's not all!!! There is a vector type for working with vectors
and matrices and doing linear algebra. They are entered with
brackets, <code>[]</code>.
</p>

<pre class="example">
2: [4, 1, 5]
1: [ [ 1, 2, 3 ]
 [ 4, 5, 6 ]
 [ 6, 7, 8 ] ]
 .
</pre>

<p>
And take the dot product, then take cross product of this vector and matrix,
</p>

<pre class="example">
2: [38, 48, 58]
1: [ [ -14, -18, -22 ]
 [ -19, -18, -17 ]
 [ 15, 18, 21 ] ]
 .
</pre>

<p>
Any matrix and vector operator you could probably think of is
available, including map and reduce (and you can define your own
expression to apply).
</p>

<p>
We can use this to solve a linear system. Find <code>x</code>
and <code>y</code> in terms of <code>a</code> and <code>b</code>,
</p>

<pre class="example">
x + a y = 6
x + b y = 10
</pre>

<p>
Enter it (note we are using symbols),
</p>

<pre class="example">
2: [6, 10]
1: [ [ 1, a ]
 [ 1, b ] ]
 .
</pre>

<p>
And divide,
</p>

<pre class="example">
 4 a 4
1: [6 + -----, -----]
 a - b b - a

 .
</pre>

<p>
But that's not all!!! We can create graphs if gnuplot is installed. We
can give it two vectors, or an algebraic expression. This plot
of <code>sin(x)</code> and <code>x cos(x)</code> was made with just a
few keystrokes,
</p>


<div class="figure">
<p><img src="file:///img/emacs/calc-plot.png" alt="calc-plot.png" />
</p>
</div>

<p>
But that's not all!!! There is an HMS type for handling times and
angles. For 2 hours, 30 minutes, and 4 seconds, and some others,
</p>

<pre class="example">
3: 2@ 30' 4"
2: 4@ 22' 13"
1: 1@ 2' 56"
 .
</pre>

<p>
Of course, the normal operators work as expected. We can add them all up,
</p>

<pre class="example">
1: 7@ 55' 13"
 .
</pre>

<p>
We can convert between this and radians, and degrees, and so on.
</p>

<p>
But that's not all!!! The calculator also has a date type, entered
inside angled brackets, <code>&lt;&gt;</code> (in algebra entry
mode). It is really flexible on input dates. We can insert the current
date with <code>t N</code>.
</p>

<pre class="example">
1: &lt;6:59:34pm Tue Jun 23, 2009&gt;
 .
</pre>

<p>
If we add numbers they are treated as days. Add 4,
</p>

<pre class="example">
1: &lt;6:59:34pm Sat Jun 27, 2009&gt;
 .
</pre>

<p>
It works with the HMS format from before too. Subtract <code>2@ 3' 15"</code>.
</p>

<pre class="example">
1: &lt;4:56:32pm Sat Jun 27, 2009&gt;
 .
</pre>

<p>
But that's not all!!! There is a modulo form for performing modulo
arithmetic. For example, 17 mod 24,
</p>

<pre class="example">
1: 17 mod 24
 .
</pre>

<p>
Add 10,
</p>

<pre class="example">
1: 3 mod 24
 .
</pre>

<p>
This is most useful for forms such as <code>n^p mod M</code>, which
this will handle efficiently. For example, <code>3^100000 mod 24</code>. The naive way would be to find <code>3^100000</code> first,
then take the modulus. This involves a computationally expensive
middle step of calculating <code>3^100000</code>, a huge number. The
modulo form does it smarter.
</p>

<p>
But that's not all!!! The calculator can do unit conversions. The
version of Emacs (22.3.1) I am typing in right now knows about 159
different units. For example, I push 65 mph onto the stack,
</p>

<pre class="example">
1: 65 mph
 .
</pre>

<p>
Convert to meters per second with <code>u c</code>,
</p>

<pre class="example">
1: 29.0576 m / s
 .
</pre>

<p>
It is flexible about mixing type of units. For example, I enter 3
cubic meters,
</p>

<pre class="example">
 3
1: 3 m

 .
</pre>

<p>
I can convert to gallons,
</p>

<pre class="example">
1: 792.516157074 gal
 .
</pre>

<p>
I work in a lab without Internet access during the day, so when I need
to do various conversions Emacs is indispensable.
</p>

<p>
The speed of light is also a unit. I can enter <code>1 c</code> and
convert to meters per second,
</p>

<pre class="example">
1: 299792458 m / s
 .
</pre>

<p>
But that's not all!!! As I said, it's a computer algebra system so it
understands symbolic math. Remember those algebraic expressions from
before? I can operate on those. Let's push some expressions onto the
stack,
</p>

<pre class="example">
3: ln(x)

 2 a x
2: a x + --- + c
 b

1: y + c

 .
</pre>

<p>
Multiply the top two, then add the third,
</p>

<pre class="example">
 2 a x
1: ln(x) + (a x + --- + c) (y + c)
 b

 .
</pre>

<p>
Expand with <code>a x</code>, then simplify with <code>a s</code>,
</p>

<pre class="example">
 2 a x y 2 a c x 2
1: ln(x) + a y x + ----- + c y + a c x + ----- + c
 b b

 .
</pre>

<p>
Now, one of the coolest features: calculus. Differentiate with respect
to x, with <code>a d</code>,
</p>

<pre class="example">
 1 a y a c
1: - + 2 a y x + --- + 2 a c x + ---
 x b b

 .
</pre>

<p>
Or undo that and integrate it,
</p>

<pre class="example">
 3 2 3 2
 a y x a x y a c x a c x 2
1: x ln(x) - x + ------ + ------ + c x y + ------ + ------ + x c
 3 2 b 3 2 b

 .
</pre>

<p>
That's just awesome! That's a text editor ... doing calculus!
</p>

<p>
So, that was most of the main features. It was kind of exhausting
going through all of that, and I am only scratching the surface of
what the calculator can do.
</p>

<p>
Naturally, it can be extended with some elisp. It provides a
<code>defmath</code> macro specifically for this.
</p>

<p>
I bet (hope?) someday it will have a functions for doing Laplace and
Fourier transforms.
</p>

</div>
</div>
<div>
        <div class="post-meta">
            <span title="post date" class="post-info">2018-11-01</span>
            <span title="last modification date" class="post-info">2018-11-01</span>
            <span title="tags" class="post-info">:<a href="/tags/raw">raw</a>:</span>
            <span title="author" class="post-info"><a href="mailto:travis &lt;at&gt; travis-job-c7de1c50-88ed-412e-ae70-62694dd7dea5">lujun9972</a></span>
        </div>
    <script src="/media/js/jquery-2.1.3.min.js"></script>
        <section>
            <h1>Comments</h1>
            <div id="comment-wrap">
                    <a class="disqus_label">使用 Disqus 评论</a>
    </ul>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
         //var disqus_developer = 1;
         var preempt_signal=false;
         var disqus_identifier = "/blog/2018/11/01/the-emacs-calculator-«-null-program/";
         var disqus_url = "https://lujun9972.github.io/emacs-document/blog/2018/11/01/the-emacs-calculator-«-null-program/";
         var disqus_shortname = 'emacs-document';
         /* * * DON'T EDIT BELOW THIS LINE * * */
         (function() {
             var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
             dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
             $('#disqus_thread').css('display','none');
         })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    <script>
     /* comments */
     var ego_disqus_thread=$('#disqus_thread');
     var ego_ds_label=$('.ds-thread');
     $('.disqus_label').click(function(){
         ego_disqus_thread.show();
         ego_ds_label.hide();
     });
     $('.ds-label').click(function(){
         ego_disqus_thread.hide();
         ego_ds_label.show();
     });
    </script>
        </section>
    <script src="/media/js/main.js"></script>
        <script type="text/javascript">
         var _gaq = _gaq || [];
         _gaq.push(['_setAccount', '7bac4fd0247f69c27887e0d4e3aee41e']);
         _gaq.push(['_trackPageview']);
         (function() {
             var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
             ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
             var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
         })();
        </script>
    <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 27.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
        <p>
            Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:travis &lt;at&gt; travis-job-c7de1c50-88ed-412e-ae70-62694dd7dea5">lujun9972</a>
            &nbsp;&nbsp;-&nbsp;&nbsp;
            Powered by <a href="https://github.com/emacs-china/ego" target="_blank">EGO</a><br/>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License" class="center"></a>
            <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
    </div>
            </div>
            <script type="text/javascript"
                    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG">
            </script>
            <script type="text/x-mathjax-config">
             MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });
            </script>
</div>

  </div>
  <!-- https://instant.page/
       Make your site’s pages instant in 1 minute and improve your conversion rate by 1%  -->
  <script src="//instant.page/1.1.0" type="module" integrity="sha384-EwBObn5QAxP8f09iemwAJljc+sU+eUXeL9vSBw1eNmVarwhKk2F9vBEpaN9rsrtp"></script>
  </body>
</html>
