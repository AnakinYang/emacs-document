<!DOCTYPE html>
<html lang="en">
<head>
  <title>TIP: 让ERC使用起来很有趣 - EMACS-DOCUMENT</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <meta name="author" content="lujun9972" />
  <meta name="keywords" content="emacs-common" />
  <!-- <link rel="stylesheet" href="../../../../../media/css/main.css" type="text/css"/>
       <link rel="stylesheet" href="../../../../../media/css/comment.css" type="text/css"/> -->
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/dark.css'>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
</head>

  <body><div class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="../../../../../">EMACS-DOCUMENT</a></h1>
    <p>=============&gt;随便,谢谢</p>
    <nav class="site-nav">
      <ul class="trigger">
        <li><a href="../../../../../years/">Years</a></li>
        <li><a href="../../../../../authors/">Authors</a></li>
        <li><a href="../../../../../tags/">Tags</a></li>
        <li><a href="../../../../../about/">About</a></li>
        <li><a href="https://github.com/lujun9972/emacs-document.git">Github</a></li>
        <li><a href="../../../../../rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="https://www.bing.com/search">
      <input type="text" class="field" name="q" id="s" placeholder="Search">
      <input type="hidden" name="as_sitesearch" value="lujun9972.github.io/emacs-document">
    </form>
  </header>
</div>

<div>
<div class="post">
<h1 class="title">TIP: 让ERC使用起来很有趣</h1>
<p>
又一个星期，又一个技巧。本周，我将根据几个人的建议，向您介绍我使用 <code>erc</code> 的方法。我为这篇相对较长的文章提前道歉，我只是想写得完整一些，这样任何人都能看懂这篇文章。
首先，如果你不知道到IRC是什么，那么我告诉你，简单的说，它允许你通过不同的渠道与他人实时沟通。
IRC是我快速获取简单问题答案的最好途径，也是我向比我更有能力的人学习的最好途径。
例如，当我学习一门新语言的时候，我喜欢做的是加入他们的IRC频道，在每天结束的时候浏览日志，试着理解他们提出的问题和答案。起初，它令人困惑，但渐渐地我熟悉了所用的词汇。
</p>

<p>
在继续下面的内容之前，我的 <code>erc</code> 看起来像这样的:
</p>


<div class="figure">
<p><img src="https://preview.redd.it/0rk9stel5h011.png" alt="0rk9stel5h011.png" />
</p>
</div>

<p>
如果你仍然有兴趣知道更多，那么让我们继续!
</p>

<p>
你需要问自己一个问题:如何使用IRC来节省你的时间而不是浪费时间，因为我们很快就会把时间花在不同的频道上，就像Reddit一样。
就我而言，理想的配置是让ERC易于阅读，只将注意力放在需要阅读的内容上，当有人回答了我的问题时，通知我。
</p>

<p>
无需详细介绍，以下是我使用的配置的起始部分:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package erc
  <span style="font-weight: bold;">:custom</span>
  (erc-autojoin-channels-alist '((<span style="font-style: italic;">"freenode.net"</span> <span style="font-style: italic;">"#archlinux"</span> <span style="font-style: italic;">"#bash"</span> <span style="font-style: italic;">"#bitcoin"</span>
                                  <span style="font-style: italic;">"#emacs"</span> <span style="font-style: italic;">"#gentoo"</span> <span style="font-style: italic;">"#i3"</span> <span style="font-style: italic;">"#latex"</span> <span style="font-style: italic;">"#org-mode"</span> <span style="font-style: italic;">"#python"</span>)))
  (erc-autojoin-timing 'ident)
  (erc-fill-function 'erc-fill-static)
  (erc-fill-static-center 22)
  (erc-hide-list '(<span style="font-style: italic;">"JOIN"</span> <span style="font-style: italic;">"PART"</span> <span style="font-style: italic;">"QUIT"</span>))
  (erc-lurker-hide-list '(<span style="font-style: italic;">"JOIN"</span> <span style="font-style: italic;">"PART"</span> <span style="font-style: italic;">"QUIT"</span>))
  (erc-lurker-threshold-time 43200)
  (erc-prompt-for-nickserv-password nil)
  (erc-server-reconnect-attempts 5)
  (erc-server-reconnect-timeout 3)
  (erc-track-exclude-types '(<span style="font-style: italic;">"JOIN"</span> <span style="font-style: italic;">"MODE"</span> <span style="font-style: italic;">"NICK"</span> <span style="font-style: italic;">"PART"</span> <span style="font-style: italic;">"QUIT"</span>
                             <span style="font-style: italic;">"324"</span> <span style="font-style: italic;">"329"</span> <span style="font-style: italic;">"332"</span> <span style="font-style: italic;">"333"</span> <span style="font-style: italic;">"353"</span> <span style="font-style: italic;">"477"</span>))
  <span style="font-weight: bold;">:config</span>
  (add-to-list 'erc-modules 'notifications)
  (add-to-list 'erc-modules 'spelling)
  (erc-services-mode 1)
  (erc-update-modules))
</pre>
</div>

<p>
大体上，它为显示提供了一个很不错的边栏，允许使用 <code>authinfo.gpg</code> 文件中的密码进行连接，用户加入或离开通道时不要告诉我，启用事件通知和实时拼写检查。
</p>

<p>
此外，对于像我这样想把密码存储在一个GPG文件中的人，你需要指定一个文件优先级列表，告诉 <code>erc</code> 从哪里开始寻找你的密码:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> auth-sources '(<span style="font-style: italic;">"~/Sync/shared/.authinfo.gpg"</span>
                     <span style="font-style: italic;">"~/.authinfo.gpg"</span>
                     <span style="font-style: italic;">"~/.authinfo"</span>
                     <span style="font-style: italic;">"~/.netrc"</span>))
</pre>
</div>

<p>
and of course, don't forget to add this line in your <code>.authinfo.gpg</code> file, where &lt;nickname&gt; and &lt;password&gt; match your real information:
当然，不要忘记在 <code>.authinfo.gpg</code> 文件中添加下面这一行，其中&lt;nickname&gt;和&lt;password&gt;使用您的真实信息:
</p>

<pre class="example">
machine irc.freenode.net login &lt;nickname&gt; password &lt;password&gt;
</pre>

<p>
<b>注意:</b> 将 <code>auth-sources</code> 替换为最适合您的那个。
</p>

<p>
如果您在看，下面我将列出一些我使用的函数，这些函数允许您补完上面的配置。
</p>

<p>
-- 为了避免打开多个 <code>erc</code> 实例，我使用了一个函数来确保只有一个连接实例存在:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my/erc-start-or-switch</span> ()
  <span style="font-style: italic;">"Connects to ERC, or switch to last active buffer."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">if</span> (get-buffer <span style="font-style: italic;">"irc.freenode.net:6667"</span>)
      (erc-track-switch-buffer 1)
    (<span style="font-weight: bold;">when</span> (y-or-n-p <span style="font-style: italic;">"Start ERC? "</span>)
      (erc <span style="font-weight: bold;">:server</span> <span style="font-style: italic;">"irc.freenode.net"</span> <span style="font-weight: bold;">:port</span> 6667 <span style="font-weight: bold;">:nick</span> <span style="font-style: italic;">"rememberYou"</span>))))
</pre>
</div>

<p>
-- 我喜欢的另一件事是，当我收到私人消息时，或者当我的昵称被某个频道所引用时，能自动收到通知，以便让我快速响应。该通知的标题为笔名,内容为信息:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my/erc-notify</span> (nickname message)
  <span style="font-style: italic;">"Displays a notification message for ERC."</span>
  (<span style="font-weight: bold;">let*</span> ((channel (buffer-name))
         (nick (erc-hl-nicks-trim-irc-nick nickname))
         (title (<span style="font-weight: bold;">if</span> (string-match-p (concat <span style="font-style: italic;">"^"</span> nickname) channel)
                    nick
                  (concat nick <span style="font-style: italic;">" ("</span> channel <span style="font-style: italic;">")"</span>)))
         (msg (s-trim (s-collapse-whitespace message))))
    (alert (concat nick <span style="font-style: italic;">": "</span> msg) <span style="font-weight: bold;">:title</span> title)))
</pre>
</div>

<p>
-- 令我烦恼的一件事是，我想知道频道上有多少人，这样我就能知道我是否能快速得到回答。这是通过以下代码完成的:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my/erc-count-users</span> ()
  <span style="font-style: italic;">"Displays the number of users connected on the current channel."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">if</span> (get-buffer <span style="font-style: italic;">"irc.freenode.net:6667"</span>)
      (<span style="font-weight: bold;">let</span> ((channel (erc-default-target)))
        (<span style="font-weight: bold;">if</span> (<span style="font-weight: bold;">and</span> channel (erc-channel-p channel))
            (message <span style="font-style: italic;">"%d users are online on %s"</span>
                     (hash-table-count erc-channel-users)
                     channel)
          (<span style="font-weight: bold;">user-error</span> <span style="font-style: italic;">"The current buffer is not a channel"</span>)))
    (<span style="font-weight: bold;">user-error</span> <span style="font-style: italic;">"You must first start ERC"</span>)))
</pre>
</div>

<p>
-- 有时我想复制和粘贴渠道中的某个资源，而让自己免于被短时间内重复消息所打扰。为了避免这些问题，这个函数能够拯救你:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my/erc-preprocess</span> (string)
  <span style="font-style: italic;">"Avoids channel flooding."</span>
  (<span style="font-weight: bold;">setq</span> str
        (string-trim
         (replace-regexp-in-string <span style="font-style: italic;">"n+"</span> <span style="font-style: italic;">" "</span> str))))
</pre>
</div>

<p>
-- 另外介绍两个我喜欢用的package。第一个是 <code>erc-hl-nicks</code>,它允许我将颜色与假名联系起来。 我发现它很方便，它会给我回答之人一个第一印象。最后，第二个包是 <code>erc-image</code>,它在通道上自动将图像链接显示图像。这使我可以无需点击链接就能查看图像:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package erc-hl-nicks
  <span style="font-weight: bold;">:after</span> erc)

(use-package erc-image
  <span style="font-weight: bold;">:after</span> erc)
</pre>
</div>

<p>
为了不让这篇文章变得太长，你可以在<a href="https://github.com/beryou/.emacs.d">GitHub</a>上找到我的完整配置。
</p>

<p>
您可以通过分享一些配置内容，以及使用的各种包来补充这篇文章。
</p>

<p>
IRC上再见!祝你有一个美好的夜晚或美好的一天，Emacs的朋友!
</p>

</div>
</div>
<div>
        <div class="post-meta">
            <span title="post date" class="post-info">2018-06-20</span>
            <span title="last modification date" class="post-info">2020-01-12</span>
            <span title="tags" class="post-info">:<a href="../../../../../tags/emacs-common">emacs-common</a>:</span>
            <span title="author" class="post-info"><a href="mailto:travis &lt;at&gt; travis-job-82b3a26d-c077-4c03-ac4d-62540bbaac1b">lujun9972</a></span>
        </div>
    <script src="../../../../../media/js/jquery-2.1.3.min.js"></script>
    <script src="../../../../../media/js/md5.min.js"></script>
        <section>
            <div id="gitalk-container"></div>
            <script type="text/javascript">
             var gitalk = new Gitalk({
                 clientID: 'fdcb5d9da3f4acb4862c',
                 clientSecret: 'dd0a16312a206782cb7669dcec5e96874ab48170',
                 repo: 'lujun9972.github.com',
                 owner: 'lujun9972',
                 admin: ['lujun9972'],
                 id: md5(location.pathname),      // Ensure uniqueness and length less than 50
                 distractionFreeMode: false  // Facebook-like distraction free mode
             })
             gitalk.render('gitalk-container')
            </script>
        </section>
    <script src="../../../../../media/js/main.js"></script>
        <script>
         var _hmt = _hmt || [];
         (function() {
             var hm = document.createElement("script");
             hm.src = "https://hm.baidu.com/hm.js?7bac4fd0247f69c27887e0d4e3aee41e";
             var s = document.getElementsByTagName("script")[0]; 
             s.parentNode.insertBefore(hm, s);
         })();
        </script>
    <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 27.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
        <p>
            Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:travis &lt;at&gt; travis-job-82b3a26d-c077-4c03-ac4d-62540bbaac1b">lujun9972</a>
            &nbsp;&nbsp;-&nbsp;&nbsp;
            Powered by <a href="https://github.com/emacs-china/ego" target="_blank">EGO</a><br/>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License" class="center"></a>
            <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
    </div>
            </div>
            <script type="text/javascript"
                    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG">
            </script>
            <script type="text/x-mathjax-config">
             MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });
            </script>
</div>

  </div>
  <!-- https://instant.page/
       Make your site’s pages instant in 1 minute and improve your conversion rate by 1%  -->
  <script src="../../../../../instant.page/1.1.0" type="module" integrity="sha384-EwBObn5QAxP8f09iemwAJljc+sU+eUXeL9vSBw1eNmVarwhKk2F9vBEpaN9rsrtp"></script>
  </body>
</html>
