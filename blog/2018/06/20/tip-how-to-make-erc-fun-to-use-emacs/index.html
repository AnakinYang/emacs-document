<!DOCTYPE html>
<html lang="en">
<head>
  <title>TIP: How to make ERC fun to use : emacs - EMACS-DOCUMENT</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <meta name="author" content="lujun9972" />
  <meta name="keywords" content="raw" />
  <!-- <link rel="stylesheet" href="../../../../../media/css/main.css" type="text/css"/>
       <link rel="stylesheet" href="../../../../../media/css/comment.css" type="text/css"/> -->
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/dark.css'>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
</head>

  <body><div class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="../../../../../">EMACS-DOCUMENT</a></h1>
    <p>=============&gt;集思广益</p>
    <nav class="site-nav">
      <ul class="trigger">
        <li><a href="../../../../../years/">Years</a></li>
        <li><a href="../../../../../authors/">Authors</a></li>
        <li><a href="../../../../../tags/">Tags</a></li>
        <li><a href="../../../../../about/">About</a></li>
        <li><a href="https://github.com/lujun9972/emacs-document">Github</a></li>
        <li><a href="../../../../../rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="https://www.bing.com/search">
      <input type="text" class="field" name="q" id="s" placeholder="Search">
      <input type="hidden" name="as_sitesearch" value="lujun9972.github.io/emacs-document">
    </form>
  </header>
</div>

<div>
<div class="post">
<h1 class="title">TIP: How to make ERC fun to use : emacs</h1>
<p>
Another week, another trick. This week, I will present you my way of using <code>erc</code>, following the recommendation of several people. I apologize in advance for the relatively long post, I just like to be complete so that anyone can understand this post. First, for those who don't know IRC, it's roughly, which allows you to communicate with other people in real time on different channels. IRC is the best way for me to get a quick answer to a simple question and to learn from more competent people than me on a subject. For example, what I like to do when I learn a new language is to join their IRC channel, scan the logs at the end of each day and try to understand the questions with their answers asked. At first, it's confusing, but little by little I am familiar with the vocabulary used.
</p>

<p>
Before going any further, here is what my <code>erc</code> looks like:
</p>

<p>
After ERC configuration
</p>

<p>
If you're still interested in knowing more, then let's keep going!
</p>

<p>
The question you need to ask yourself is how to use IRC so that it saves you more time than waste, because we quickly tend to spend our days sailing between the different channels, a bit like on Reddit. For my part, I wanted a configuration that was pleasant to read, targeting only what is necessary to be read and that informs me when someone has answered my question.
</p>

<p>
Without going into details, here is the beginning of the configuration that I use:
</p>

<pre class="example">
(use-package erc
 :custom
 (erc-autojoin-channels-alist '(("freenode.net" "#archlinux" "#bash" "#bitcoin"
 "#emacs" "#gentoo" "#i3" "#latex" "#org-mode" "#python")))
 (erc-autojoin-timing 'ident)
 (erc-fill-function 'erc-fill-static)
 (erc-fill-static-center 22)
 (erc-hide-list '("JOIN" "PART" "QUIT"))
 (erc-lurker-hide-list '("JOIN" "PART" "QUIT"))
 (erc-lurker-threshold-time 43200)
 (erc-prompt-for-nickserv-password nil)
 (erc-server-reconnect-attempts 5)
 (erc-server-reconnect-timeout 3)
 (erc-track-exclude-types '("JOIN" "MODE" "NICK" "PART" "QUIT"
 "324" "329" "332" "333" "353" "477"))
 :config
 (add-to-list 'erc-modules 'notifications)
 (add-to-list 'erc-modules 'spelling)
 (erc-services-mode 1)
 (erc-update-modules))
</pre>

<p>
Roughly, this makes it possible to make a nice margin for the display, allow a connection using the password from my <code>authinfo.gpg</code> file, avoid warning me when a user joins and leaves a channel, enable notifications and the spell checking on the fly.
</p>

<p>
Besides, for people like me, who want to store your password in a GPG file, you just need to specify a file priority list, to tell <code>erc</code> where to start looking for your password first:
</p>

<pre class="example">
(setq auth-sources '("~/Sync/shared/.authinfo.gpg"
 "~/.authinfo.gpg"
 "~/.authinfo"
 "~/.netrc"))
</pre>

<p>
and of course, don't forget to add this line in your <code>.authinfo.gpg</code> file, where &lt;nickname&gt; and &lt;password&gt; match your real information:
</p>

<pre class="example">
machine irc.freenode.net login &lt;nickname&gt; password &lt;password&gt;
</pre>

<p>
<b>NOTE:</b> replace <code>auth-sources</code> with the one that suits you best.
</p>

<p>
If you are still with me, I will list you some functions that I use, which allow to complete the configuration presented above.
</p>

<p>
-- In order to avoid opening several <code>erc</code> instances, I use a function that will ensure that only one connection instance exists:
</p>

<pre class="example">
(defun my/erc-start-or-switch ()
 "Connects to ERC, or switch to last active buffer."
 (interactive)
 (if (get-buffer "irc.freenode.net:6667")
 (erc-track-switch-buffer 1)
 (when (y-or-n-p "Start ERC? ")
 (erc :server "irc.freenode.net" :port 6667 :nick "rememberYou"))))
</pre>

<p>
-- Another thing that I like, is to automatically receive a notification when I get a private message, or when my nickname is quoted on a channel so I can respond quickly. This notification includes as title the pseudonym of the person as well as his message as content:​​
</p>

<pre class="example">
(defun my/erc-notify (nickname message)
 "Displays a notification message for ERC."
 (let* ((channel (buffer-name))
 (nick (erc-hl-nicks-trim-irc-nick nickname))
 (title (if (string-match-p (concat "^" nickname) channel)
 nick
 (concat nick " (" channel ")")))
 (msg (s-trim (s-collapse-whitespace message))))
 (alert (concat nick ": " msg) :title title)))
</pre>

<p>
-- One thing that bothered me about <code>erc</code> was that I liked to know how many people were on the channel so I could get an idea if I was going to get a quick answer or not. This is done with the following code:
</p>

<pre class="example">
(defun my/erc-count-users ()
 "Displays the number of users connected on the current channel."
 (interactive)
 (if (get-buffer "irc.freenode.net:6667")
 (let ((channel (erc-default-target)))
 (if (and channel (erc-channel-p channel))
 (message "%d users are online on %s"
 (hash-table-count erc-channel-users)
 channel)
 (user-error "The current buffer is not a channel")))
 (user-error "You must first start ERC")))
</pre>

<p>
-- From time to time I wanted to copy and paste a source on a channel, and get myself kicked for spam after sending this message several times in a short time. To avoid these problems, this function comes to your rescue:​
</p>

<pre class="example">
(defun my/erc-preprocess (string)
 "Avoids channel flooding."
 (setq str
 (string-trim
 (replace-regexp-in-string "\n+" " " str))))
</pre>

<p>
-- Two other packages I like to use. The first package is <code>erc-hl-nicks</code>, which allows me to associate a color with a pseudonym. I find it convenient because it gives me a first visual impression if a person answered. Finally, the second package is <code>erc-image</code>, which automatically displays images as links, on a channel. This allows me to avoid having to click on the link to see the image:
</p>

<pre class="example">
(use-package erc-hl-nicks
 :after erc)

(use-package erc-image
 :after erc)
</pre>

<p>
In order to not overload this post, you can find my complete configuration on <a href="https://github.com/rememberYou/.emacs.d">GitHub</a>.
</p>

<p>
Feel free to complete this post by sharing a few points of your configuration that you want to share, as well as various packages that you use.
</p>

<p>
See you soon on IRC! I wish you a good evening or a good day, Emacs friend!
</p>

</div>
</div>
<div>
        <div class="post-meta">
            <span title="post date" class="post-info">2018-06-20</span>
            <span title="last modification date" class="post-info">2018-06-20</span>
            <span title="tags" class="post-info">:<a href="../../../../../tags/raw">raw</a>:</span>
            <span title="author" class="post-info"><a href="mailto:lujun9972 &lt;at&gt; T520">lujun9972</a></span>
        </div>
    <script src="../../../../../media/js/jquery-2.1.3.min.js"></script>
    <script src="../../../../../media/js/md5.min.js"></script>
        <section>
            <div id="gitalk-container"></div>
            <script type="text/javascript">
             var gitalk = new Gitalk({
                 clientID: 'fdcb5d9da3f4acb4862c',
                 clientSecret: 'dd0a16312a206782cb7669dcec5e96874ab48170',
                 repo: 'lujun9972.github.com',
                 owner: 'lujun9972',
                 admin: ['lujun9972'],
                 id: md5(location.pathname),      // Ensure uniqueness and length less than 50
                 distractionFreeMode: false  // Facebook-like distraction free mode
             })
             gitalk.render('gitalk-container')
            </script>
        </section>
    <script src="../../../../../media/js/main.js"></script>
    <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 26.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
        <p>
            Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:lujun9972 &lt;at&gt; T520">lujun9972</a>
            &nbsp;&nbsp;-&nbsp;&nbsp;
            Powered by <a href="https://github.com/emacs-china/ego" target="_blank">EGO</a><br/>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License" class="center"></a>
            <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
    </div>
            </div>
            <script type="text/javascript"
                    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG">
            </script>
            <script type="text/x-mathjax-config">
             MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });
            </script>
</div>

  </div>
  <!-- https://instant.page/
       Make your site’s pages instant in 1 minute and improve your conversion rate by 1%  -->
  <script src="../../../../../instant.page/1.1.0" type="module" integrity="sha384-EwBObn5QAxP8f09iemwAJljc+sU+eUXeL9vSBw1eNmVarwhKk2F9vBEpaN9rsrtp"></script>
  </body>
</html>
